{
  "hash": "59e2a92550265ebba5f680d76e01b015",
  "result": {
    "markdown": "---\ntitle: Visualization I\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    toc-location: right\n    code-fold: false\n    theme:\n      - cosmo\n      - cerulean\n    callout-icon: false\n---\n\n::: {.callout-note collapse=\"false\"}\n## Learning Outcomes\n- Use `matplotlib` and `seaborn` to create data visualizations.\n- Analyze histograms and identify the skewness, potential outliers, and the mode.\n- Use `boxplot` and `violinplot` to compare two distributions.\n:::\n\n**This content is covered in lecture 7.**\n\nIn our journey of the data science lifecycle, we have begun to explore the vast world of exploratory data analysis. More recently, we learned how to pre-process data using various data manipulation techniques. As we work towards understanding our data, there is one key component missing in our arsenal — the ability to visualize and discern relationships in existing data.\n\nThese next two lectures will introduce you to various examples of data visualizations and their underlying theory. In doing so, we'll motivate their importance in real-world examples with the use of plotting libraries.\n\n## Visualizations in Data 8 and Data 100 (so far)\n\nYou've likely encountered several forms of data visualizations in your studies. You may remember two such examples from Data 8: line plots and histograms. Each of these served a unique purpose. For example, line plots displayed how numerical quantities changed over time, while histograms were useful in understanding a variable's distribution. \n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n**Line Chart**\n\n<img src=\"images/line_chart_viz.png\" alt='line_chart_viz' width='300'>\n:::\n\n::: {.column width=\"30%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"30%\"}\n**Histogram**\n\n<img src=\"images/histogram_viz.png\" alt='histogram_viz' width='300'>\n:::\n\n::::\n\n## Goals of Visualization\n\nVisualizations are useful for a number of reasons. In Data 100, we consider two areas in particular:\n\n1. To broaden your understanding of the data\n    - Key part in exploratory data analysis.\n    - Useful in investigating relationships between variables.\n2. To communicate results/conclusions to others \n    - Visualization theory is especially important here.\n\nOne of the most common applications of visualizations is in understanding a distribution of data.\n\nThis course note will focus on the first half of visualization topics in Data 100. The goal here is to understand how to choose the \"right\" plot depending on different variable types and, secondly, how to generate these plots using code.\n\n## An Overview of Distributions\n\nA distribution describes the frequency of unique values in a variable. Distributions must satisfy two properties:\n\n   1. Each data point must belong to only one category.\n   2. The total frequency of all categories must sum to 100%. In other words, their total count should equal the number of values in consideration.\n   \n:::: {.columns}\n\n::: {.column width=\"30%\"}\n**Not a Valid Distribution**\n\n<img src=\"images/bad_distro.png\" alt='bad_distro' width='300'>\n:::\n\n::: {.column width=\"30%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"30%\"}\n**Valid Distribution**\n\n<img src=\"images/good_distro.png\" alt='good_distro' width='300'>\n:::\n\n::::\n\nLeft Diagram: This is not a valid distribution since individuals can be associated with more than one category and the bar values demonstrate values in minutes and not probability. \n\nRight Diagram: This example satisfies the two properties of distributions, so it is a valid distribution.\n\n## Variable Types Should Inform Plot Choice\n\nDifferent plots are more or less suited for displaying particular types of variables, laid out in the diagram below:\n\n<img src=\"images/variable_types_vis_1.png\" alt='variable_types_diagram' width='600'>\n\n\n## Bar Plots\n\nAs we saw above, a **bar plot** is one of the most common ways of displaying the distribution of a **qualitative** (categorical) variable. The length of a bar plot encodes the frequency of a category; the width encodes no useful information. The color *could* indicate a sub-category, but this is not necessarily the case. \n\nLet's contextualize this in an example. We will use the World Bank dataset (`wb`) in our analysis.\n\n::: {.cell tags='[]' vscode='{\"languageId\":\"python\"}' execution_count=1}\n``` {.python .cell-code code-fold=\"true\"}\nimport pandas as pd\nimport numpy as np\n\nwb = pd.read_csv(\"data/world_bank.csv\", index_col=0)\nwb.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Continent</th>\n      <th>Country</th>\n      <th>Primary completion rate: Male: % of relevant age group: 2015</th>\n      <th>Primary completion rate: Female: % of relevant age group: 2015</th>\n      <th>Lower secondary completion rate: Male: % of relevant age group: 2015</th>\n      <th>Lower secondary completion rate: Female: % of relevant age group: 2015</th>\n      <th>Youth literacy rate: Male: % of ages 15-24: 2005-14</th>\n      <th>Youth literacy rate: Female: % of ages 15-24: 2005-14</th>\n      <th>Adult literacy rate: Male: % ages 15 and older: 2005-14</th>\n      <th>Adult literacy rate: Female: % ages 15 and older: 2005-14</th>\n      <th>...</th>\n      <th>Access to improved sanitation facilities: % of population: 1990</th>\n      <th>Access to improved sanitation facilities: % of population: 2015</th>\n      <th>Child immunization rate: Measles: % of children ages 12-23 months: 2015</th>\n      <th>Child immunization rate: DTP3: % of children ages 12-23 months: 2015</th>\n      <th>Children with acute respiratory infection taken to health provider: % of children under age 5 with ARI: 2009-2016</th>\n      <th>Children with diarrhea who received oral rehydration and continuous feeding: % of children under age 5 with diarrhea: 2009-2016</th>\n      <th>Children sleeping under treated bed nets: % of children under age 5: 2009-2016</th>\n      <th>Children with fever receiving antimalarial drugs: % of children under age 5 with fever: 2009-2016</th>\n      <th>Tuberculosis: Treatment success rate: % of new cases: 2014</th>\n      <th>Tuberculosis: Cases detection rate: % of new estimated cases: 2015</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Africa</td>\n      <td>Algeria</td>\n      <td>106.0</td>\n      <td>105.0</td>\n      <td>68.0</td>\n      <td>85.0</td>\n      <td>96.0</td>\n      <td>92.0</td>\n      <td>83.0</td>\n      <td>68.0</td>\n      <td>...</td>\n      <td>80.0</td>\n      <td>88.0</td>\n      <td>95.0</td>\n      <td>95.0</td>\n      <td>66.0</td>\n      <td>42.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>88.0</td>\n      <td>80.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Africa</td>\n      <td>Angola</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>79.0</td>\n      <td>67.0</td>\n      <td>82.0</td>\n      <td>60.0</td>\n      <td>...</td>\n      <td>22.0</td>\n      <td>52.0</td>\n      <td>55.0</td>\n      <td>64.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>25.9</td>\n      <td>28.3</td>\n      <td>34.0</td>\n      <td>64.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Africa</td>\n      <td>Benin</td>\n      <td>83.0</td>\n      <td>73.0</td>\n      <td>50.0</td>\n      <td>37.0</td>\n      <td>55.0</td>\n      <td>31.0</td>\n      <td>41.0</td>\n      <td>18.0</td>\n      <td>...</td>\n      <td>7.0</td>\n      <td>20.0</td>\n      <td>75.0</td>\n      <td>79.0</td>\n      <td>23.0</td>\n      <td>33.0</td>\n      <td>72.7</td>\n      <td>25.9</td>\n      <td>89.0</td>\n      <td>61.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Africa</td>\n      <td>Botswana</td>\n      <td>98.0</td>\n      <td>101.0</td>\n      <td>86.0</td>\n      <td>87.0</td>\n      <td>96.0</td>\n      <td>99.0</td>\n      <td>87.0</td>\n      <td>89.0</td>\n      <td>...</td>\n      <td>39.0</td>\n      <td>63.0</td>\n      <td>97.0</td>\n      <td>95.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>77.0</td>\n      <td>62.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Africa</td>\n      <td>Burundi</td>\n      <td>58.0</td>\n      <td>66.0</td>\n      <td>35.0</td>\n      <td>30.0</td>\n      <td>90.0</td>\n      <td>88.0</td>\n      <td>89.0</td>\n      <td>85.0</td>\n      <td>...</td>\n      <td>42.0</td>\n      <td>48.0</td>\n      <td>93.0</td>\n      <td>94.0</td>\n      <td>55.0</td>\n      <td>43.0</td>\n      <td>53.8</td>\n      <td>25.4</td>\n      <td>91.0</td>\n      <td>51.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 47 columns</p>\n</div>\n```\n:::\n:::\n\n\nWe can visualize the distribution of the `Continent` column using a bar plot. There are a few ways to do this.\n\n### Plotting in Pandas\n\n::: {.cell tags='[]' vscode='{\"languageId\":\"python\"}' execution_count=2}\n``` {.python .cell-code}\nwb['Continent'].value_counts().plot(kind = 'bar');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-3-output-1.png){width=566 height=472}\n:::\n:::\n\n\nRecall that `.value_counts()` returns a `Series` with the total count of each unique value. We call `.plot(kind = 'bar')` on this result to visualize these counts as a bar plot.\n\nPlotting methods in `pandas` are the least preferred and not supported in Data 100, as their functionality is limited. Instead, future examples will focus on other libraries built specifically for visualizing data. The most well-known library here is `matplotlib`.\n\n### Plotting in Matplotlib\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=3}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt # matplotlib is typically given the alias plt\n\ncontinent = wb['Continent'].value_counts()\nplt.bar(continent.index, continent)\nplt.xlabel('Continent')\nplt.ylabel('Count');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-4-output-1.png){width=585 height=429}\n:::\n:::\n\n\nWhile more code is required to achieve the same result, `matplotlib` is often used over `pandas` for its ability to plot more complex visualizations, some of which are discussed shortly.\n\nHowever, note how we needed to label the axes with `plt.xlabel` and `plt.ylabel` - `matplotlib` does not support automatic axis labeling. To get around these inconveniences, we can use a more efficient plotting library, `seaborn`.\n\n### Plotting in Seaborn\n\n::: {.cell tags='[]' vscode='{\"languageId\":\"python\"}' execution_count=4}\n``` {.python .cell-code}\nimport seaborn as sns # seaborn is typically given the alias sns\nsns.countplot(data = wb, x = 'Continent');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-5-output-1.png){width=585 height=429}\n:::\n:::\n\n\n`seaborn.countplot` both counts and visualizes the number of unique values in a given column. This column is specified by the `x` argument to `sns.countplot`, while the `DataFrame` is specified by the `data` argument. In contrast to `matplotlib`, the general structure of a `seaborn` call involves passing in an entire `DataFrame`, and then specifying what column(s) to plot.\n\nFor the vast majority of visualizations, `seaborn` is far more concise and aesthetically pleasing than `matplotlib`. However, the color scheme of this particular bar plot is arbitrary - it encodes no additional information about the categories themselves. This is not always true; color may signify meaningful detail in other visualizations. We'll explore this more in-depth during the next lecture.\n\nBy now, you'll have noticed that each of these plotting libraries have a very different syntax. As with `pandas`, we'll teach you the important methods in `matplotlib` and `seaborn`, but you'll learn more through documentation.\n\n1. [Matplotlib Documentation](https://matplotlib.org/stable/index.html)\n2. [Seaborn Documentation](https://seaborn.pydata.org/)\n\nThinking back to our second goal, when we want to use visualizations to communicate results/conclusions to others, we must consider:\n\n- What colors should we use?\n- How wide should the bars be?\n- Should the legend exist?\n- Should the bars and axes have dark borders?\n\nTo accomplish this, here are some ways we can improve a plot:\n\n- Introducing different colors for each bar\n- Including a legend\n- Including a title\n- Labeling the y-axis\n- Using color-blind friendly palettes\n- Re-orienting the labels\n- Increase the font size\n\n\n## Distributions of Quantitative Variables\n\nRevisiting our example with the `wb` DataFrame, let's plot the distribution of `Gross national income per capita`.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=5}\n``` {.python .cell-code code-fold=\"true\"}\nwb.head(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Continent</th>\n      <th>Country</th>\n      <th>Primary completion rate: Male: % of relevant age group: 2015</th>\n      <th>Primary completion rate: Female: % of relevant age group: 2015</th>\n      <th>Lower secondary completion rate: Male: % of relevant age group: 2015</th>\n      <th>Lower secondary completion rate: Female: % of relevant age group: 2015</th>\n      <th>Youth literacy rate: Male: % of ages 15-24: 2005-14</th>\n      <th>Youth literacy rate: Female: % of ages 15-24: 2005-14</th>\n      <th>Adult literacy rate: Male: % ages 15 and older: 2005-14</th>\n      <th>Adult literacy rate: Female: % ages 15 and older: 2005-14</th>\n      <th>...</th>\n      <th>Access to improved sanitation facilities: % of population: 1990</th>\n      <th>Access to improved sanitation facilities: % of population: 2015</th>\n      <th>Child immunization rate: Measles: % of children ages 12-23 months: 2015</th>\n      <th>Child immunization rate: DTP3: % of children ages 12-23 months: 2015</th>\n      <th>Children with acute respiratory infection taken to health provider: % of children under age 5 with ARI: 2009-2016</th>\n      <th>Children with diarrhea who received oral rehydration and continuous feeding: % of children under age 5 with diarrhea: 2009-2016</th>\n      <th>Children sleeping under treated bed nets: % of children under age 5: 2009-2016</th>\n      <th>Children with fever receiving antimalarial drugs: % of children under age 5 with fever: 2009-2016</th>\n      <th>Tuberculosis: Treatment success rate: % of new cases: 2014</th>\n      <th>Tuberculosis: Cases detection rate: % of new estimated cases: 2015</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Africa</td>\n      <td>Algeria</td>\n      <td>106.0</td>\n      <td>105.0</td>\n      <td>68.0</td>\n      <td>85.0</td>\n      <td>96.0</td>\n      <td>92.0</td>\n      <td>83.0</td>\n      <td>68.0</td>\n      <td>...</td>\n      <td>80.0</td>\n      <td>88.0</td>\n      <td>95.0</td>\n      <td>95.0</td>\n      <td>66.0</td>\n      <td>42.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>88.0</td>\n      <td>80.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Africa</td>\n      <td>Angola</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>79.0</td>\n      <td>67.0</td>\n      <td>82.0</td>\n      <td>60.0</td>\n      <td>...</td>\n      <td>22.0</td>\n      <td>52.0</td>\n      <td>55.0</td>\n      <td>64.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>25.9</td>\n      <td>28.3</td>\n      <td>34.0</td>\n      <td>64.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Africa</td>\n      <td>Benin</td>\n      <td>83.0</td>\n      <td>73.0</td>\n      <td>50.0</td>\n      <td>37.0</td>\n      <td>55.0</td>\n      <td>31.0</td>\n      <td>41.0</td>\n      <td>18.0</td>\n      <td>...</td>\n      <td>7.0</td>\n      <td>20.0</td>\n      <td>75.0</td>\n      <td>79.0</td>\n      <td>23.0</td>\n      <td>33.0</td>\n      <td>72.7</td>\n      <td>25.9</td>\n      <td>89.0</td>\n      <td>61.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Africa</td>\n      <td>Botswana</td>\n      <td>98.0</td>\n      <td>101.0</td>\n      <td>86.0</td>\n      <td>87.0</td>\n      <td>96.0</td>\n      <td>99.0</td>\n      <td>87.0</td>\n      <td>89.0</td>\n      <td>...</td>\n      <td>39.0</td>\n      <td>63.0</td>\n      <td>97.0</td>\n      <td>95.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>77.0</td>\n      <td>62.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Africa</td>\n      <td>Burundi</td>\n      <td>58.0</td>\n      <td>66.0</td>\n      <td>35.0</td>\n      <td>30.0</td>\n      <td>90.0</td>\n      <td>88.0</td>\n      <td>89.0</td>\n      <td>85.0</td>\n      <td>...</td>\n      <td>42.0</td>\n      <td>48.0</td>\n      <td>93.0</td>\n      <td>94.0</td>\n      <td>55.0</td>\n      <td>43.0</td>\n      <td>53.8</td>\n      <td>25.4</td>\n      <td>91.0</td>\n      <td>51.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 47 columns</p>\n</div>\n```\n:::\n:::\n\n\nHow should we define our categories for this variable? In the previous example, these were a few unique values of the `Continent` column. If we use similar logic here, our categories are the different numerical values contained in the `Gross national income per capita` column.\n\nUnder this assumption, let's plot this distribution using the `seaborn.countplot` function.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=6}\n``` {.python .cell-code}\nsns.countplot(data = wb, x = 'Gross national income per capita, Atlas method: $: 2016');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-7-output-1.png){width=615 height=429}\n:::\n:::\n\n\nWhat happened? A bar plot (either `plt.bar` or `sns.countplot`) will create a separate bar for each unique value of a variable. With a continuous variable, we may not have a finite number of possible values, which can lead to situations where we would need many, many bars to display each unique value.\n\nSpecifically, we can say this histogram suffers from **overplotting** as we are unable to interpret the plot and gain any meaningful insight. \n\nRather than bar plots, to visualize the distribution of a continuous variable, we use one of the following types of plots:\n\n- Histogram\n- Box plot\n- Violin plot\n\n## Box Plots and Violin Plots\n\nBox plots and violin plots are two very similar kinds of visualizations. Both display the distribution of a variable using information about quartiles.\n\nIn a box plot, the width of the box at any point does not encode meaning. In a violin plot, the width of the plot indicates the density of the distribution at each possible value.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=7}\n``` {.python .cell-code}\nsns.boxplot(data=wb, y='Gross national income per capita, Atlas method: $: 2016');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-8-output-1.png){width=610 height=393}\n:::\n:::\n\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=8}\n``` {.python .cell-code}\nsns.violinplot(data=wb, y=\"Gross national income per capita, Atlas method: $: 2016\");\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-9-output-1.png){width=619 height=396}\n:::\n:::\n\n\nA quartile represents a 25% portion of the data. We say that:\n\n- The first quartile (Q1) represents the 25th percentile – 25% of the data lies below the first quartile.\n- The second quartile (Q2) represents the 50th percentile, also known as the median – 50% of the data lies below the second quartile.\n- The third quartile (Q3) represents the 75th percentile – 75% of the data lies below the third quartile.\n\nThis means that the middle 50% of the data lies between the first and third quartiles. This is demonstrated in the histogram below. The three quartiles are marked with red vertical bars.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=9}\n``` {.python .cell-code}\ngdp = wb['Gross domestic product: % growth : 2016']\ngdp = gdp[~gdp.isna()]\n\nq1, q2, q3 = np.percentile(gdp, [25, 50, 75])\n\nwb_quartiles = wb.copy()\nwb_quartiles['category'] = None\nwb_quartiles.loc[(wb_quartiles['Gross domestic product: % growth : 2016'] < q1) | (wb_quartiles['Gross domestic product: % growth : 2016'] > q3), 'category'] = 'Outside of the middle 50%'\nwb_quartiles.loc[(wb_quartiles['Gross domestic product: % growth : 2016'] > q1) & (wb_quartiles['Gross domestic product: % growth : 2016'] < q3), 'category'] = 'In the middle 50%'\n\nsns.histplot(wb_quartiles, x=\"Gross domestic product: % growth : 2016\", hue=\"category\")\nsns.rugplot([q1, q2, q3], c=\"firebrick\", lw=6, height=0.1);\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-10-output-1.png){width=585 height=429}\n:::\n:::\n\n\nIn a box plot, the lower extent of the box lies at Q1, while the upper extent of the box lies at Q3. The horizontal line in the middle of the box corresponds to Q2 (equivalently, the median).\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=10}\n``` {.python .cell-code}\nsns.boxplot(data=wb, y='Gross domestic product: % growth : 2016');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-11-output-1.png){width=596 height=393}\n:::\n:::\n\n\nThe **whiskers** of a box-plot are the two points that lie at the \\[$1^{st}$ Quartile $-$ ($1.5\\times$ IQR)\\], and the \\[$3^{rd}$ Quartile $+$ ($1.5\\times$ IQR)\\]. They are the lower and upper ranges of \"normal\" data (the points excluding outliers). \n\nThe different forms of information contained in a box plot can be summarised as follows:\n\n<img src=\"images/box_plot_diagram.png\" alt='box_plot_diagram' width='600'>\n\nA violin plot displays quartile information, albeit a bit more subtly. Look closely at the center vertical bar of the violin plot below!\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=11}\n``` {.python .cell-code}\nsns.violinplot(data=wb, y='Gross domestic product: % growth : 2016');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-12-output-1.png){width=596 height=393}\n:::\n:::\n\n\n## Side-by-Side Box and Violin Plots\n\nPlotting side-by-side box or violin plots allows us to compare distributions across different categories. In other words, they enable us to plot both a qualitative variable and a quantitative continuous variable in one visualization.\n\nWith `seaborn`, we can easily create side-by-side plots by specifying both an x and y column.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=12}\n``` {.python .cell-code}\nsns.boxplot(data=wb, x=\"Continent\", y='Gross domestic product: % growth : 2016');\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-13-output-1.png){width=596 height=429}\n:::\n:::\n\n\n## Plotting Histograms\n\nYou are likely familiar with histograms from Data 8. A histogram collects continuous data into bins, then plots this binned data. Each bin reflects the density of datapoints with values that lie between the left and right ends of the bin.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=13}\n``` {.python .cell-code}\n# The `edgecolor` argument controls the color of the bin edges\ngni = wb[\"Gross national income per capita, Atlas method: $: 2016\"]\nplt.hist(gni, density=True, edgecolor=\"white\")\n\n# Add labels\nplt.xlabel(\"Gross national income per capita\")\nplt.ylabel(\"Density\")\nplt.title(\"Distribution of gross national income per capita\");\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-14-output-1.png){width=576 height=449}\n:::\n:::\n\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=14}\n``` {.python .cell-code}\nsns.histplot(data=wb, x=\"Gross national income per capita, Atlas method: $: 2016\", stat=\"density\")\nplt.title(\"Distribution of gross national income per capita\");\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-15-output-1.png){width=623 height=449}\n:::\n:::\n\n\n### Overlaid Histograms\n\nWe can overlay histograms (or density curves) to compare distributions across qualitative categories.\n\nThe `hue` parameter of `sns.histplot` specifies the column that should be used to determine the color of each category. `hue` can be used in many `seaborn` plotting functions.\n\nNotice that the resulting plot includes a legend describing which color corresponds to each hemisphere – a legend should always be included if color is used to encode information in a visualization!\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=15}\n``` {.python .cell-code}\n# Create a new variable to store the hemisphere in which each country is located\nnorth = [\"Asia\", \"Europe\", \"N. America\"]\nsouth = [\"Africa\", \"Oceania\", \"S. America\"]\nwb.loc[wb[\"Continent\"].isin(north), \"Hemisphere\"] = \"Northern\"\nwb.loc[wb[\"Continent\"].isin(south), \"Hemisphere\"] = \"Southern\"\n```\n:::\n\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=16}\n``` {.python .cell-code}\nsns.histplot(data=wb, x=\"Gross national income per capita, Atlas method: $: 2016\", hue=\"Hemisphere\", stat=\"density\")\nplt.title(\"Distribution of gross national income per capita\");\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-17-output-1.png){width=576 height=449}\n:::\n:::\n\n\nEach bin of a histogram is scaled such that its area is equal to the percentage of all datapoints that it contains.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=17}\n``` {.python .cell-code}\ndensities, bins, _ = plt.hist(gni, density=True, edgecolor=\"white\", bins=5)\nplt.xlabel(\"Gross national income per capita\")\nplt.ylabel(\"Density\")\n\nprint(f\"First bin has width {bins[1]-bins[0]} and height {densities[0]}\")\nprint(f\"This corresponds to {bins[1]-bins[0]} * {densities[0]} = {(bins[1]-bins[0])*densities[0]*100}% of the data\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nFirst bin has width 16410.0 and height 4.7741589911386953e-05\nThis corresponds to 16410.0 * 4.7741589911386953e-05 = 78.343949044586% of the data\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-18-output-2.png){width=576 height=443}\n:::\n:::\n\n\n## Evaluating Histograms\n\nHistograms allow us to assess a distribution by their shape. There are a few properties of histograms we can analyze:\n\n1. Skewness and Tails\n    - Skewed left vs skewed right\n    - Left tail vs right tail\n2. Outliers\n    - Using percentiles\n3. Modes\n    - Most commonly occuring data\n\n### Skewness and Tails\n\nThe skew of a histogram describes the direction in which its \"tail\" extends.\n- A distribution with a long right tail is **skewed right** (such as `Gross national income per capita`). In a right-skewed distribution, the few large outliers \"pull\" the mean to the **right** of the median. \n- A distribution with a long left tail is **skewed left** (such as `Access to an improved water source`). In a left-skewed distribution, the few small outliers \"pull\" the mean to the **left** of the median. \n\nIn the case where a distribution has equal-sized right and left tails, it is **symmetric**. The mean is approximately **equal** to the median. Think of mean as the balancing point of the distribution.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=18}\n``` {.python .cell-code}\nsns.histplot(data = wb, x = 'Gross national income per capita, Atlas method: $: 2016', stat = 'density');\nplt.title('Distribution with a long right tail')\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```\nText(0.5, 1.0, 'Distribution with a long right tail')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-19-output-2.png){width=623 height=449}\n:::\n:::\n\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=19}\n``` {.python .cell-code}\nsns.histplot(data = wb, x = 'Access to an improved water source: % of population: 2015', stat = 'density');\nplt.title('Distribution with a long left tail')\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```\nText(0.5, 1.0, 'Distribution with a long left tail')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-20-output-2.png){width=597 height=449}\n:::\n:::\n\n\n### Outliers\n\nLoosely speaking, an **outlier** is defined as a data point that lies an abnormally large distance away from other values. Let's make this more concrete. As you may have observed in the box plot infographic earlier, we define **outliers** to be the data points that fall beyond the whiskers. Specifically, values that are less than the \\[$1^{st}$ Quartile $-$ ($1.5\\times$ IQR)\\], or greater than \\[$3^{rd}$ Quartile $+$ ($1.5\\times$ IQR).\\]\n\n### Modes\n\nIn Data 100, we describe a \"mode\" of a histogram as a peak in the distribution. Often, however, it is difficult to determine what counts as its own \"peak.\" For example, the number of peaks in the distribution of HIV rates across different countries varies depending on the number of histogram bins we plot.\n\nIf we set the number of bins to 5, the distribution appears unimodal.\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=20}\n``` {.python .cell-code}\n# Rename the very long column name for convenience\nwb = wb.rename(columns={'Antiretroviral therapy coverage: % of people living with HIV: 2015':\"HIV rate\"})\n# With 5 bins, it seems that there is only one peak\nsns.histplot(data=wb, x=\"HIV rate\", stat=\"density\", bins=5)\nplt.title(\"5 histogram bins\");\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-21-output-1.png){width=614 height=449}\n:::\n:::\n\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=21}\n``` {.python .cell-code}\n# With 10 bins, there seem to be two peaks\n\nsns.histplot(data=wb, x=\"HIV rate\", stat=\"density\", bins=10)\nplt.title(\"10 histogram bins\");\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-22-output-1.png){width=606 height=449}\n:::\n:::\n\n\n::: {.cell vscode='{\"languageId\":\"python\"}' execution_count=22}\n``` {.python .cell-code}\n# And with 20 bins, it becomes hard to say what counts as a \"peak\"!\n\nsns.histplot(data=wb, x =\"HIV rate\", stat=\"density\", bins=20)\nplt.title(\"20 histogram bins\");\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization_1_files/figure-html/cell-23-output-1.png){width=606 height=449}\n:::\n:::\n\n\nIn part, it is these ambiguities that motivate us to consider using Kernel Density Estimation (KDE), which we will explore more in the next lecture.\n\n",
    "supporting": [
      "visualization_1_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}