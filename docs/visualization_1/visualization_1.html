<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Visualization I – Data 100: Principles and Techniques of Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/data100_logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-42ed7287b56c5c583e2c2463c9cf4916.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../visualization_1/visualization_1.html">Visualization I</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/images/data100_logo.png" alt="Data 100 logo" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../assets/images/data100_logo.png" alt="Data 100 logo" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data 100 Course Notes</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/DS-100/course-notes" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_lec/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas_1/pandas_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas_2/pandas_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas_3/pandas_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas III</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../eda/eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Cleaning and EDA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regex/regex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regular Expressions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../visualization_1/visualization_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Visualization I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../visualization_2/visualization_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sampling/sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modeling_slr/modeling_slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling &amp; SLR</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../constant_model_loss_transformations/loss_transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constant Model, Loss, and Transformations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ols/ols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ordinary Least Squares</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../case_study_HCE/case_study_HCE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case Study in Human Contexts and Ethics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gradient_descent/gradient_descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">sklearn and Gradient Descent</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../feature_engineering/feature_engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gradient Descent Continuation, Feature Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cv_regularization/cv_reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cross Validation and Regularization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability_1/probability_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability_2/probability_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimators, Bias, and Variance</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../inference_causality/inference_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parameter Inference and Bootstrapping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sql_I/sql_I.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sql_II/sql_II.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../logistic_regression_1/logistic_reg_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../logistic_regression_2/logistic_reg_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../clustering/clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pca/pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PCA</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#visualizations-in-data-8-and-data-100-so-far" id="toc-visualizations-in-data-8-and-data-100-so-far" class="nav-link active" data-scroll-target="#visualizations-in-data-8-and-data-100-so-far">Visualizations in Data 8 and Data 100 (so far)</a></li>
  <li><a href="#goals-of-visualization" id="toc-goals-of-visualization" class="nav-link" data-scroll-target="#goals-of-visualization">Goals of Visualization</a></li>
  <li><a href="#an-overview-of-distributions" id="toc-an-overview-of-distributions" class="nav-link" data-scroll-target="#an-overview-of-distributions">An Overview of Distributions</a></li>
  <li><a href="#variable-types-should-inform-plot-choice" id="toc-variable-types-should-inform-plot-choice" class="nav-link" data-scroll-target="#variable-types-should-inform-plot-choice">Variable Types Should Inform Plot Choice</a></li>
  <li><a href="#qualitative-variables-bar-plots" id="toc-qualitative-variables-bar-plots" class="nav-link" data-scroll-target="#qualitative-variables-bar-plots">Qualitative Variables: Bar Plots</a>
  <ul>
  <li><a href="#plotting-in-pandas" id="toc-plotting-in-pandas" class="nav-link" data-scroll-target="#plotting-in-pandas">Plotting in Pandas</a></li>
  <li><a href="#plotting-in-matplotlib" id="toc-plotting-in-matplotlib" class="nav-link" data-scroll-target="#plotting-in-matplotlib">Plotting in Matplotlib</a></li>
  <li><a href="#plotting-in-seaborn" id="toc-plotting-in-seaborn" class="nav-link" data-scroll-target="#plotting-in-seaborn">Plotting in <code>Seaborn</code></a></li>
  </ul></li>
  <li><a href="#distributions-of-quantitative-variables" id="toc-distributions-of-quantitative-variables" class="nav-link" data-scroll-target="#distributions-of-quantitative-variables">Distributions of Quantitative Variables</a>
  <ul>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms">Histograms</a>
  <ul>
  <li><a href="#plotting-histograms" id="toc-plotting-histograms" class="nav-link" data-scroll-target="#plotting-histograms">Plotting Histograms</a></li>
  <li><a href="#overlaid-histograms" id="toc-overlaid-histograms" class="nav-link" data-scroll-target="#overlaid-histograms">Overlaid Histograms</a></li>
  <li><a href="#interpreting-histograms" id="toc-interpreting-histograms" class="nav-link" data-scroll-target="#interpreting-histograms">Interpreting Histograms</a>
  <ul class="collapse">
  <li><a href="#skewness-and-tails" id="toc-skewness-and-tails" class="nav-link" data-scroll-target="#skewness-and-tails">Skewness and Tails</a></li>
  <li><a href="#modes" id="toc-modes" class="nav-link" data-scroll-target="#modes">Modes</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">Outliers</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#box-plots" id="toc-box-plots" class="nav-link" data-scroll-target="#box-plots">Box Plots</a></li>
  <li><a href="#side-by-side-box-plots" id="toc-side-by-side-box-plots" class="nav-link" data-scroll-target="#side-by-side-box-plots">Side-by-Side Box plots</a></li>
  <li><a href="#violin-plots" id="toc-violin-plots" class="nav-link" data-scroll-target="#violin-plots">Violin Plots</a></li>
  </ul></li>
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">Kernel Density Estimation</a>
  <ul>
  <li><a href="#kde-theory" id="toc-kde-theory" class="nav-link" data-scroll-target="#kde-theory">KDE Theory</a></li>
  <li><a href="#constructing-a-kde" id="toc-constructing-a-kde" class="nav-link" data-scroll-target="#constructing-a-kde">Constructing a KDE</a>
  <ul>
  <li><a href="#step-1-place-a-kernel-at-each-data-point" id="toc-step-1-place-a-kernel-at-each-data-point" class="nav-link" data-scroll-target="#step-1-place-a-kernel-at-each-data-point">Step 1: Place a Kernel at Each Data Point</a></li>
  <li><a href="#step-2-normalize-kernels-to-have-a-total-area-of-1" id="toc-step-2-normalize-kernels-to-have-a-total-area-of-1" class="nav-link" data-scroll-target="#step-2-normalize-kernels-to-have-a-total-area-of-1">Step 2: Normalize Kernels to Have a Total Area of 1</a></li>
  <li><a href="#step-3-sum-the-normalized-kernels" id="toc-step-3-sum-the-normalized-kernels" class="nav-link" data-scroll-target="#step-3-sum-the-normalized-kernels">Step 3: Sum the Normalized Kernels</a></li>
  </ul></li>
  <li><a href="#mathematical-notation-of-kde" id="toc-mathematical-notation-of-kde" class="nav-link" data-scroll-target="#mathematical-notation-of-kde">Mathematical Notation of KDE</a>
  <ul>
  <li><a href="#gaussian-kernel" id="toc-gaussian-kernel" class="nav-link" data-scroll-target="#gaussian-kernel">Gaussian Kernel</a></li>
  <li><a href="#boxcar-kernel" id="toc-boxcar-kernel" class="nav-link" data-scroll-target="#boxcar-kernel">Boxcar Kernel</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Visualization I</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Learning Outcomes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Understand the theories behind effective visualizations and start to generate plots of our own with <code>matplotlib</code> and <code>seaborn</code>.</li>
<li>Analyze histograms and identify the skewness, potential outliers, and the mode.</li>
<li>Use <code>boxplot</code> and <code>violinplot</code> to compare two distributions.</li>
</ul>
</div>
</div>
</div>
<p>In our journey of the data science lifecycle, we have begun to explore the vast world of exploratory data analysis. More recently, we learned how to pre-process data using various data manipulation techniques. As we work towards understanding our data, there is one key component missing in our arsenal — the ability to visualize and discern relationships in existing data.</p>
<p>These next two lectures will introduce you to various examples of data visualizations and their underlying theory. In doing so, we’ll motivate their importance in real-world examples with the use of plotting libraries.</p>
<section id="visualizations-in-data-8-and-data-100-so-far" class="level2">
<h2 class="anchored" data-anchor-id="visualizations-in-data-8-and-data-100-so-far">Visualizations in Data 8 and Data 100 (so far)</h2>
<p>You’ve likely encountered several forms of data visualizations in your studies. You may remember two such examples from Data 8: line plots, scatter plots, and histograms. Each of these served a unique purpose. For example, line plots displayed how numerical quantities changed over time, while histograms were useful in understanding a variable’s distribution.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Line Chart</th>
<th>Scatter Plot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="images/line_chart_viz.png" alt="Example of a line chart" width="300"></td>
<td><img src="images/scatter.png" alt="Example of a scatterplot" width="300"></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th>Histogram</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="images/histogram_viz.png" alt="Example of a histogram" width="400"></td>
</tr>
</tbody>
</table>
</section>
<section id="goals-of-visualization" class="level2">
<h2 class="anchored" data-anchor-id="goals-of-visualization">Goals of Visualization</h2>
<p>Visualizations are useful for a number of reasons. In Data 100, we consider two areas in particular:</p>
<ol type="1">
<li>To broaden your understanding of the data. Summarizing trends visually before in-depth analysis is a key part of exploratory data analysis. Creating these graphs is a lightweight, iterative and flexible process that helps us investigate relationships between variables.</li>
<li>To communicate results/conclusions to others. These visualizations are highly editorial, selective, and fine-tuned to achieve a communications goal, so be thoughtful and careful about its clarity, accessibility, and necessary context.</li>
</ol>
<p>Altogether, these goals emphasize the fact that visualizations aren’t a matter of making “pretty” pictures; we need to do a lot of thinking about what stylistic choices communicate ideas most effectively.</p>
<p>This course note will focus on the first half of visualization topics in Data 100. The goal here is to understand how to choose the “right” plot depending on different variable types and, secondly, how to generate these plots using code.</p>
</section>
<section id="an-overview-of-distributions" class="level2">
<h2 class="anchored" data-anchor-id="an-overview-of-distributions">An Overview of Distributions</h2>
<p>A distribution describes both the set of values that a single variable can take and the frequency of unique values in a single variable. For example, if we’re interested in the distribution of students across Data 100 discussion sections, the set of possible values is a list of discussion sections (10-11am, 11-12pm, etc.), and the frequency that each of those values occur is the number of students enrolled in each section. In other words, we’re interested in how a variable is distributed across it’s possible values. Therefore, distributions must satisfy two properties:</p>
<ol type="1">
<li>The total frequency of all categories must sum to 100%</li>
<li>Total count should sum to the total number of datapoints if we’re using raw counts.</li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Not a Valid Distribution</th>
<th>Valid Distribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="images/bad_distro.png" alt="Example of a non-valid distribution" width="350"></td>
<td><img src="images/good_distro.png" alt="Example of a valid distribution where the sum of categories totals 100." width="300"></td>
</tr>
<tr class="even">
<td>This is not a valid distribution since individuals can be associated with more than one category and the bar values demonstrate values in minutes and not probability.</td>
<td>This example satisfies the two properties of distributions, so it is a valid distribution.</td>
</tr>
</tbody>
</table>
</section>
<section id="variable-types-should-inform-plot-choice" class="level2">
<h2 class="anchored" data-anchor-id="variable-types-should-inform-plot-choice">Variable Types Should Inform Plot Choice</h2>
<p>Different plots are more or less suited for displaying particular types of variables, laid out in the diagram below:</p>
<center>
<img src="images/variables.png" width="500" alt="Variables can either be qualitative or quantitative. If a variable is qualitative, it can be either ordinal or nominal">
</center>
<p>The first step of any visualization is to identify the type(s) of variables we’re working with. From here, we can select an appropriate plot type:</p>
</section>
<section id="qualitative-variables-bar-plots" class="level2">
<h2 class="anchored" data-anchor-id="qualitative-variables-bar-plots">Qualitative Variables: Bar Plots</h2>
<p>A <strong>bar plot</strong> is one of the most common ways of displaying the <strong>distribution</strong> of a <strong>qualitative</strong> (categorical) variable. The length of a bar plot encodes the frequency of a category; the width encodes no useful information. The color <em>could</em> indicate a sub-category, but this is not necessarily the case.</p>
<p>Let’s contextualize this in an example. We will use the World Bank dataset (<code>wb</code>) in our analysis.</p>
<div id="946a7ec2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, <span class="st">"use_inf_as_na"</span>) <span class="co"># Supresses distracting deprecation warnings</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>wb <span class="op">=</span> pd.read_csv(<span class="st">"data/world_bank.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>wb.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Continent</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Primary completion rate: Male: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Primary completion rate: Female: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Lower secondary completion rate: Male: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Lower secondary completion rate: Female: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Youth literacy rate: Male: % of ages 15-24: 2005-14</th>
<th data-quarto-table-cell-role="th">Youth literacy rate: Female: % of ages 15-24: 2005-14</th>
<th data-quarto-table-cell-role="th">Adult literacy rate: Male: % ages 15 and older: 2005-14</th>
<th data-quarto-table-cell-role="th">Adult literacy rate: Female: % ages 15 and older: 2005-14</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Access to improved sanitation facilities: % of population: 1990</th>
<th data-quarto-table-cell-role="th">Access to improved sanitation facilities: % of population: 2015</th>
<th data-quarto-table-cell-role="th">Child immunization rate: Measles: % of children ages 12-23 months: 2015</th>
<th data-quarto-table-cell-role="th">Child immunization rate: DTP3: % of children ages 12-23 months: 2015</th>
<th data-quarto-table-cell-role="th">Children with acute respiratory infection taken to health provider: % of children under age 5 with ARI: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children with diarrhea who received oral rehydration and continuous feeding: % of children under age 5 with diarrhea: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children sleeping under treated bed nets: % of children under age 5: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children with fever receiving antimalarial drugs: % of children under age 5 with fever: 2009-2016</th>
<th data-quarto-table-cell-role="th">Tuberculosis: Treatment success rate: % of new cases: 2014</th>
<th data-quarto-table-cell-role="th">Tuberculosis: Cases detection rate: % of new estimated cases: 2015</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Africa</td>
<td>Algeria</td>
<td>106.0</td>
<td>105.0</td>
<td>68.0</td>
<td>85.0</td>
<td>96.0</td>
<td>92.0</td>
<td>83.0</td>
<td>68.0</td>
<td>...</td>
<td>80.0</td>
<td>88.0</td>
<td>95.0</td>
<td>95.0</td>
<td>66.0</td>
<td>42.0</td>
<td>NaN</td>
<td>NaN</td>
<td>88.0</td>
<td>80.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Africa</td>
<td>Angola</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>79.0</td>
<td>67.0</td>
<td>82.0</td>
<td>60.0</td>
<td>...</td>
<td>22.0</td>
<td>52.0</td>
<td>55.0</td>
<td>64.0</td>
<td>NaN</td>
<td>NaN</td>
<td>25.9</td>
<td>28.3</td>
<td>34.0</td>
<td>64.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Africa</td>
<td>Benin</td>
<td>83.0</td>
<td>73.0</td>
<td>50.0</td>
<td>37.0</td>
<td>55.0</td>
<td>31.0</td>
<td>41.0</td>
<td>18.0</td>
<td>...</td>
<td>7.0</td>
<td>20.0</td>
<td>75.0</td>
<td>79.0</td>
<td>23.0</td>
<td>33.0</td>
<td>72.7</td>
<td>25.9</td>
<td>89.0</td>
<td>61.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Africa</td>
<td>Botswana</td>
<td>98.0</td>
<td>101.0</td>
<td>86.0</td>
<td>87.0</td>
<td>96.0</td>
<td>99.0</td>
<td>87.0</td>
<td>89.0</td>
<td>...</td>
<td>39.0</td>
<td>63.0</td>
<td>97.0</td>
<td>95.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>77.0</td>
<td>62.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Africa</td>
<td>Burundi</td>
<td>58.0</td>
<td>66.0</td>
<td>35.0</td>
<td>30.0</td>
<td>90.0</td>
<td>88.0</td>
<td>89.0</td>
<td>85.0</td>
<td>...</td>
<td>42.0</td>
<td>48.0</td>
<td>93.0</td>
<td>94.0</td>
<td>55.0</td>
<td>43.0</td>
<td>53.8</td>
<td>25.4</td>
<td>91.0</td>
<td>51.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 47 columns</p>
</div>
</div>
</div>
<p>We can visualize the distribution of the <code>Continent</code> column using a bar plot. There are a few ways to do this.</p>
<section id="plotting-in-pandas" class="level3">
<h3 class="anchored" data-anchor-id="plotting-in-pandas">Plotting in Pandas</h3>
<div id="27649ef3" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>wb[<span class="st">'Continent'</span>].value_counts().plot(kind<span class="op">=</span><span class="st">'bar'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-3-output-1.png" alt="A bar plot with each continent on the x-axis. The heights of the bars correspond to the value count for each continent. Africa has the tallest bar and S. America has the shortest." width="566" height="490" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Recall that <code>.value_counts()</code> returns a <code>Series</code> with the total count of each unique value. We call <code>.plot(kind='bar')</code> on this result to visualize these counts as a bar plot.</p>
<p>Plotting methods in <code>pandas</code> are the least preferred and not supported in Data 100, as their functionality is limited. Instead, future examples will focus on other libraries built specifically for visualizing data. The most well-known library here is <code>matplotlib</code>.</p>
</section>
<section id="plotting-in-matplotlib" class="level3">
<h3 class="anchored" data-anchor-id="plotting-in-matplotlib">Plotting in Matplotlib</h3>
<div id="21c22f39" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt <span class="co"># matplotlib is typically given the alias plt</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>continent <span class="op">=</span> wb[<span class="st">'Continent'</span>].value_counts()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.bar(continent.index, continent)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Continent'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-4-output-1.png" alt="A bar plot with each continent on the x-axis and count on the y-axis. The heights of the bars correspond to the value count for each continent. Africa has the tallest bar and S. America has the shortest." width="585" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While more code is required to achieve the same result, <code>matplotlib</code> is often used over <code>pandas</code> for its ability to plot more complex visualizations, some of which are discussed shortly.</p>
<p>However, note how we needed to label the axes with <code>plt.xlabel</code> and <code>plt.ylabel</code>, as <code>matplotlib</code> does not support automatic axis labeling. To get around these inconveniences, we can use a more efficient plotting library: <code>seaborn</code>.</p>
</section>
<section id="plotting-in-seaborn" class="level3">
<h3 class="anchored" data-anchor-id="plotting-in-seaborn">Plotting in <code>Seaborn</code></h3>
<div id="b3cbc556" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns <span class="co"># seaborn is typically given the alias sns</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data <span class="op">=</span> wb, x <span class="op">=</span> <span class="st">'Continent'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-5-output-1.png" alt="A bar plot with each continent on the x-axis and count on the y-axis. The heights of the bars correspond to the value count for each continent. Africa has the tallest bar and S. America has the shortest." width="585" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In contrast to <code>matplotlib</code>, the general structure of a <code>seaborn</code> call involves passing in an entire <code>DataFrame</code>, and then specifying what column(s) to plot. <code>seaborn.countplot</code> both counts and visualizes the number of unique values in a given column. This column is specified by the <code>x</code> argument to <code>sns.countplot</code>, while the <code>DataFrame</code> is specified by the <code>data</code> argument.</p>
<blockquote class="blockquote">
<p><code>seaborn</code> is built on <code>matplotlib</code>! When using <code>seaborn</code>, you’re actually using <code>matplotlib</code> under the hood, but with an easier-to-use interface for working with <code>DataFrame</code>s and creating certain types of plots.</p>
</blockquote>
<p>For the vast majority of visualizations, <code>seaborn</code> is far more concise and aesthetically pleasing than <code>matplotlib</code>. However, the color scheme of this particular bar plot is arbitrary - it encodes no additional information about the categories themselves. This is not always true; color may signify meaningful detail in other visualizations. We’ll explore this more in-depth during the next lecture.</p>
<p>By now, you’ll have noticed that each of these plotting libraries have a very different syntax. As with <code>pandas</code>, we’ll teach you the important methods in <code>matplotlib</code> and <code>seaborn</code>, but you’ll learn more through documentation.</p>
<ol type="1">
<li><a href="https://matplotlib.org/stable/index.html">Matplotlib Documentation</a></li>
<li><a href="https://seaborn.pydata.org/">Seaborn Documentation</a></li>
</ol>
</section>
</section>
<section id="distributions-of-quantitative-variables" class="level2">
<h2 class="anchored" data-anchor-id="distributions-of-quantitative-variables">Distributions of Quantitative Variables</h2>
<p>Revisiting our example with the <code>wb</code> DataFrame, let’s plot the distribution of <code>Gross national income per capita</code>.</p>
<div id="466c5baa" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>wb.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Continent</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Primary completion rate: Male: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Primary completion rate: Female: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Lower secondary completion rate: Male: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Lower secondary completion rate: Female: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Youth literacy rate: Male: % of ages 15-24: 2005-14</th>
<th data-quarto-table-cell-role="th">Youth literacy rate: Female: % of ages 15-24: 2005-14</th>
<th data-quarto-table-cell-role="th">Adult literacy rate: Male: % ages 15 and older: 2005-14</th>
<th data-quarto-table-cell-role="th">Adult literacy rate: Female: % ages 15 and older: 2005-14</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Access to improved sanitation facilities: % of population: 1990</th>
<th data-quarto-table-cell-role="th">Access to improved sanitation facilities: % of population: 2015</th>
<th data-quarto-table-cell-role="th">Child immunization rate: Measles: % of children ages 12-23 months: 2015</th>
<th data-quarto-table-cell-role="th">Child immunization rate: DTP3: % of children ages 12-23 months: 2015</th>
<th data-quarto-table-cell-role="th">Children with acute respiratory infection taken to health provider: % of children under age 5 with ARI: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children with diarrhea who received oral rehydration and continuous feeding: % of children under age 5 with diarrhea: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children sleeping under treated bed nets: % of children under age 5: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children with fever receiving antimalarial drugs: % of children under age 5 with fever: 2009-2016</th>
<th data-quarto-table-cell-role="th">Tuberculosis: Treatment success rate: % of new cases: 2014</th>
<th data-quarto-table-cell-role="th">Tuberculosis: Cases detection rate: % of new estimated cases: 2015</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Africa</td>
<td>Algeria</td>
<td>106.0</td>
<td>105.0</td>
<td>68.0</td>
<td>85.0</td>
<td>96.0</td>
<td>92.0</td>
<td>83.0</td>
<td>68.0</td>
<td>...</td>
<td>80.0</td>
<td>88.0</td>
<td>95.0</td>
<td>95.0</td>
<td>66.0</td>
<td>42.0</td>
<td>NaN</td>
<td>NaN</td>
<td>88.0</td>
<td>80.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Africa</td>
<td>Angola</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>79.0</td>
<td>67.0</td>
<td>82.0</td>
<td>60.0</td>
<td>...</td>
<td>22.0</td>
<td>52.0</td>
<td>55.0</td>
<td>64.0</td>
<td>NaN</td>
<td>NaN</td>
<td>25.9</td>
<td>28.3</td>
<td>34.0</td>
<td>64.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Africa</td>
<td>Benin</td>
<td>83.0</td>
<td>73.0</td>
<td>50.0</td>
<td>37.0</td>
<td>55.0</td>
<td>31.0</td>
<td>41.0</td>
<td>18.0</td>
<td>...</td>
<td>7.0</td>
<td>20.0</td>
<td>75.0</td>
<td>79.0</td>
<td>23.0</td>
<td>33.0</td>
<td>72.7</td>
<td>25.9</td>
<td>89.0</td>
<td>61.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Africa</td>
<td>Botswana</td>
<td>98.0</td>
<td>101.0</td>
<td>86.0</td>
<td>87.0</td>
<td>96.0</td>
<td>99.0</td>
<td>87.0</td>
<td>89.0</td>
<td>...</td>
<td>39.0</td>
<td>63.0</td>
<td>97.0</td>
<td>95.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>77.0</td>
<td>62.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Africa</td>
<td>Burundi</td>
<td>58.0</td>
<td>66.0</td>
<td>35.0</td>
<td>30.0</td>
<td>90.0</td>
<td>88.0</td>
<td>89.0</td>
<td>85.0</td>
<td>...</td>
<td>42.0</td>
<td>48.0</td>
<td>93.0</td>
<td>94.0</td>
<td>55.0</td>
<td>43.0</td>
<td>53.8</td>
<td>25.4</td>
<td>91.0</td>
<td>51.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 47 columns</p>
</div>
</div>
</div>
<p>How should we define our categories for this variable? In the previous example, these were a few unique values of the <code>Continent</code> column. If we use similar logic here, our categories are the different numerical values contained in the <code>Gross national income per capita</code> column.</p>
<p>Under this assumption, let’s plot this distribution using the <code>seaborn.countplot</code> function.</p>
<div id="b9b6dab7" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data <span class="op">=</span> wb, x <span class="op">=</span> <span class="st">'Gross national income per capita, Atlas method: $: 2016'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-7-output-1.png" alt="Countplot is used to create a plot with Gross national income per capita, Atlas method: $: 2016 on the x-axis and count on the y. Most data has a count of 1, some have a count of 2, and one has a count of 3." width="615" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>What happened? A bar plot (either <code>plt.bar</code> or <code>sns.countplot</code>) will create a separate bar for each unique value of a variable. With a quantitative variable, we may not have a finite number of possible values, which can lead to situations like above where we would need many, many bars to display each unique value.</p>
<p>Specifically, we can say this histogram suffers from <strong>overplotting</strong> as we are unable to interpret the plot and gain any meaningful insight.</p>
<p>Rather than bar plots, to visualize the distribution of a quantitative variable, we use one of the following types of plots:</p>
<ul>
<li>Histogram</li>
<li>Box plot</li>
<li>Violin plot</li>
</ul>
<section id="histograms" class="level3">
<h3 class="anchored" data-anchor-id="histograms">Histograms</h3>
<p>You are likely familiar with histograms from Data 8. A histogram collects quantitative data into bins, then plots this binned data.<br>
<br>
Each bin reflects the density of datapoints with values that lie between the left and right ends of the bin; in other words, the <strong>area</strong> (not height!) of each bin is proportional to the <strong>percentage</strong> of datapoints it contains.</p>
<section id="plotting-histograms" class="level4">
<h4 class="anchored" data-anchor-id="plotting-histograms">Plotting Histograms</h4>
<p>Below, we plot a histogram using matplotlib and seaborn. Which graph do you prefer?</p>
<div id="5d7b6c9d" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The `edgecolor` argument controls the color of the bin edges</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>gni <span class="op">=</span> wb[<span class="st">"Gross national income per capita, Atlas method: $: 2016"</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.hist(gni, density<span class="op">=</span><span class="va">True</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Gross national income per capita"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of gross national income per capita"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-8-output-1.png" alt="Histogram plotted using matplotlib. The bars are solid blue and the density value labels on the y-axis are integers 0 to 7 with the annotation 1e-5." width="576" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="603cebb2" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>wb, x<span class="op">=</span><span class="st">"Gross national income per capita, Atlas method: $: 2016"</span>, stat<span class="op">=</span><span class="st">"density"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of gross national income per capita"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-9-output-1.png" alt="Histogram plotted using seaborn. The bars are a lighter blue with black outlines. The density value labels on the y-axis are decimal points with leading zeroes." width="623" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="overlaid-histograms" class="level4">
<h4 class="anchored" data-anchor-id="overlaid-histograms">Overlaid Histograms</h4>
<p>We can overlay histograms (or density curves) to compare <strong>quantitative</strong> distributions across <strong>qualitative</strong> categories.</p>
<p>The <code>hue</code> parameter of <code>sns.histplot</code> specifies the column that should be used to determine the color of each category. <code>hue</code> can be used in many <code>seaborn</code> plotting functions.</p>
<p>Notice that the resulting plot includes a legend describing which color corresponds to each hemisphere – a legend should always be included if color is used to encode information in a visualization!</p>
<div id="6914db12" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new variable to store the hemisphere in which each country is located</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>north <span class="op">=</span> [<span class="st">"Asia"</span>, <span class="st">"Europe"</span>, <span class="st">"N. America"</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>south <span class="op">=</span> [<span class="st">"Africa"</span>, <span class="st">"Oceania"</span>, <span class="st">"S. America"</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>wb.loc[wb[<span class="st">"Continent"</span>].isin(north), <span class="st">"Hemisphere"</span>] <span class="op">=</span> <span class="st">"Northern"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>wb.loc[wb[<span class="st">"Continent"</span>].isin(south), <span class="st">"Hemisphere"</span>] <span class="op">=</span> <span class="st">"Southern"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="edf5c6dc" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>wb, x<span class="op">=</span><span class="st">"Gross national income per capita, Atlas method: $: 2016"</span>, hue<span class="op">=</span><span class="st">"Hemisphere"</span>, stat<span class="op">=</span><span class="st">"density"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of gross national income per capita"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-11-output-1.png" alt="Overlaid histograms with the south hemisphere in blue and the north hemisphere in orange. Easy comparisons can be made within the same bin for each hemisphere." width="576" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Again, each bin of a histogram is scaled such that its <strong>area</strong> is proportional to the <strong>percentage</strong> of all datapoints that it contains.</p>
<div id="c0585f56" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>densities, bins, _ <span class="op">=</span> plt.hist(gni, density<span class="op">=</span><span class="va">True</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>, bins<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Gross national income per capita"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"First bin has width </span><span class="sc">{</span>bins[<span class="dv">1</span>]<span class="op">-</span>bins[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> and height </span><span class="sc">{</span>densities[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"This corresponds to </span><span class="sc">{</span>bins[<span class="dv">1</span>]<span class="op">-</span>bins[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> * </span><span class="sc">{</span>densities[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>(bins[<span class="dv">1</span>]<span class="op">-</span>bins[<span class="dv">0</span>])<span class="op">*</span>densities[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% of the data"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>First bin has width 16410.0 and height 4.7741589911386953e-05
This corresponds to 16410.0 * 4.7741589911386953e-05 = 78.343949044586% of the data</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-12-output-2.png" alt="Histogram of gross national income per capita." width="576" height="443" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpreting-histograms" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-histograms">Interpreting Histograms</h4>
<p>Histograms allow us to assess a distribution by their shape. There are a few properties of histograms we can analyze:</p>
<ol type="1">
<li>Skewness and Tails
<ul>
<li>Skewed left (negative skew) vs skewed right (positive skew)</li>
<li>Left tail vs right tail</li>
</ul></li>
<li>Modes
<ul>
<li>Most commonly occuring data</li>
</ul></li>
<li>Outliers
<ul>
<li>Using quartiles/percentiles</li>
</ul></li>
</ol>
<section id="skewness-and-tails" class="level5">
<h5 class="anchored" data-anchor-id="skewness-and-tails">Skewness and Tails</h5>
<p>The skew of a histogram describes the direction in which its “tail” extends.</p>
<ul>
<li>A distribution with a long right tail is <strong>skewed right</strong>, or has <strong>positive skew</strong> (such as <code>Gross national income per capita</code>). In a right-skewed distribution, the few large outliers “pull” the <strong>mean</strong> to the <strong>right</strong> of the <strong>median</strong>.</li>
<li>A good way to remember this is that it looks like a “<strong>P</strong>” on its side for <strong>P</strong>ositive skew!</li>
</ul>
<div id="ba084470" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> wb, x <span class="op">=</span> <span class="st">'Gross national income per capita, Atlas method: $: 2016'</span>, stat <span class="op">=</span> <span class="st">'density'</span>)<span class="op">;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution with a long right tail'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-13-output-1.png" alt="Distribution with a long right tail. The highest bars are on the very left of the graph and as you progress to the right side of the graph, the bars stay short." width="623" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>A distribution with a long left tail is <strong>skewed left</strong> (has <strong>negative skew</strong>) (such as <code>Access to an improved water source</code>). In a left-skewed distribution, the few small outliers “pull” the <strong>mean</strong> to the <strong>left</strong> of the <strong>median</strong>.</li>
</ul>
<div id="d53d1a5b" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> wb, x <span class="op">=</span> <span class="st">'Access to an improved water source: </span><span class="sc">% o</span><span class="st">f population: 2015'</span>, stat <span class="op">=</span> <span class="st">'density'</span>)<span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution with a long left tail'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-14-output-1.png" alt="Distribution with a long right tail. The highest bars are on the very right of the graph and as you progress to the left side of the graph, the bars are short." width="597" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the case where a distribution has equal-sized right and left tails, it is <strong>symmetric</strong>. The mean is approximately <strong>equal</strong> to the median. Think of mean as the balancing point of the distribution.</p>
</section>
<section id="modes" class="level5">
<h5 class="anchored" data-anchor-id="modes">Modes</h5>
<p>The <strong>mode</strong> is the <strong>mo</strong>st frequent value in a distribution. In Data 100, we describe a “mode” of a histogram as a peak in the distribution. As there may be multiple “peaks” in a distribution, we can talk about multiple modes. Often, however, it is difficult to determine what counts as its own “peak.” For example, the number of peaks in the distribution of HIV rates across different countries varies depending on the number of histogram bins we plot.</p>
<p>If we set the number of bins to 5, the distribution appears <strong>unimodal</strong> (has one clear peak/mode).</p>
<div id="543c902d" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the very long column name for convenience</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>wb <span class="op">=</span> wb.rename(columns<span class="op">=</span>{<span class="st">'Antiretroviral therapy coverage: </span><span class="sc">% o</span><span class="st">f people living with HIV: 2015'</span>:<span class="st">"HIV rate"</span>})</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># With 5 bins, it seems that there is only one peak</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>wb, x<span class="op">=</span><span class="st">"HIV rate"</span>, stat<span class="op">=</span><span class="st">"density"</span>, bins<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"5 histogram bins"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-15-output-1.png" alt="Histogram with five bins." width="614" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4632167c" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With 10 bins, there seem to be two peaks</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>wb, x<span class="op">=</span><span class="st">"HIV rate"</span>, stat<span class="op">=</span><span class="st">"density"</span>, bins<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"10 histogram bins"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-16-output-1.png" alt="The same data is plotted again in a histogram, this time with ten bins. Here you can see there seems to be two peaks." width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If a distribution has two peaks/modes, it is called <strong>bimodal</strong>. If a distribution has more peaks than that, we say it is <strong>multimodal</strong>.</p>
<div id="75ee693e" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And with 20 bins, it becomes hard to say what counts as a "peak"!</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>wb, x <span class="op">=</span><span class="st">"HIV rate"</span>, stat<span class="op">=</span><span class="st">"density"</span>, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"20 histogram bins"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-17-output-1.png" alt="The same data is plotted again in a histogram, this time with twenty bins. Here it becomes hard to say what counts as a &quot;peak&quot;!" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In part, it is these ambiguities that motivate us to consider using Kernel Density Estimation (KDE), which we will explore more later in this note.</p>
</section>
<section id="outliers" class="level5">
<h5 class="anchored" data-anchor-id="outliers">Outliers</h5>
<p>In a loose sense, an <strong>outlier</strong> is a data point that lies an abnormally large distance away from other values. However, in order to make this more concrete, we define outliers using quartiles.</p>
<section id="quartiles" class="level6">
<h6 class="anchored" data-anchor-id="quartiles">Quartiles</h6>
<p>Quartiles are a way of dividing data points into four quarters of roughly equal size. Each of the four quartiles is defined by its percentile.</p>
<p>For a quantitative variable:</p>
<ul>
<li>The <strong>1st quartile</strong> (<strong>Q1</strong>) is the 25th percentile of the distribution; 25% of the data is smaller than or equal to Q1.</li>
<li>The <strong>2nd quartile</strong> (<strong>Q2</strong>) is the 50th percentile of the distribution, or equivalently the <strong>median</strong> of the distribution. 50% of the data is smaller than or equal to Q2.</li>
<li>The <strong>3rd quartile</strong> (<strong>Q3</strong>) is the 75th percentile of the distribution; 75% of the data is smaller than or equal to Q3.</li>
</ul>
<p>The interval <strong>[Q1, Q3]</strong> contains the “middle 50% of the data.”</p>
<p>This concept is illustrated in the histogram below, where the three quartiles are marked with red vertical bars.R)</p>
<div id="23a8990c" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>gdp <span class="op">=</span> wb[<span class="st">'Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016'</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>gdp <span class="op">=</span> gdp[<span class="op">~</span>gdp.isna()]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>q1, q2, q3 <span class="op">=</span> np.percentile(gdp, [<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>])</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>wb_quartiles <span class="op">=</span> wb.copy()</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>wb_quartiles[<span class="st">'category'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>wb_quartiles.loc[(wb_quartiles[<span class="st">'Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016'</span>] <span class="op">&lt;</span> q1) <span class="op">|</span> (wb_quartiles[<span class="st">'Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016'</span>] <span class="op">&gt;</span> q3), <span class="st">'category'</span>] <span class="op">=</span> <span class="st">'Outside of the middle 50%'</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>wb_quartiles.loc[(wb_quartiles[<span class="st">'Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016'</span>] <span class="op">&gt;</span> q1) <span class="op">&amp;</span> (wb_quartiles[<span class="st">'Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016'</span>] <span class="op">&lt;</span> q3), <span class="st">'category'</span>] <span class="op">=</span> <span class="st">'In the middle 50%'</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>sns.histplot(wb_quartiles, x<span class="op">=</span><span class="st">"Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016"</span>, hue<span class="op">=</span><span class="st">"category"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>sns.rugplot([q1, q2, q3], c<span class="op">=</span><span class="st">"firebrick"</span>, lw<span class="op">=</span><span class="dv">6</span>, height<span class="op">=</span><span class="fl">0.1</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-18-output-1.png" alt="A Histogram is overlaid with a rug plot. The histogram consists of two colors of bars. The middle 50% is in blue and has the tallest bars in the center of the distribution. The other bars are in orange and they are shorter and on either side of the center blue bars. The rug plot marks the 25th, 50th, and 75th percentiles which align with the start, middle, and end of the blue bars respectively." width="585" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br>
The <strong>Interquartile range (IQR)</strong> is a measure of spread of a distribution. You can calculate the IQR of a distribution with the formula below.</p>
<ul>
<li>IQR = Q3 - Q1</li>
</ul>
<p>We define <strong>outliers</strong> by the following formula:</p>
<ul>
<li>Values &gt; Q3 <span class="math inline">\(+\)</span> (<span class="math inline">\(1.5\times\)</span> IQR)</li>
<li>Values &lt; Q1 <span class="math inline">\(-\)</span> (<span class="math inline">\(1.5\times\)</span> IQR)</li>
</ul>
</section>
</section>
</section>
</section>
<section id="box-plots" class="level3">
<h3 class="anchored" data-anchor-id="box-plots">Box Plots</h3>
<p>Box plots display the distribution of a variable using information about <strong>quartiles</strong>.</p>
<p>In a box plot, the lower extent of the box lies at Q1, while the upper extent of the box lies at Q3. The horizontal line in the middle of the box corresponds to Q2 (equivalently, the median). This can be seen in the box plot below.</p>
<div id="5644344b" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>wb, y<span class="op">=</span><span class="st">'Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-19-output-1.png" alt="Example box plot." width="596" height="393" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The <strong>whiskers</strong> of a box-plot are the two points that lie at the [<span class="math inline">\(1^{st}\)</span> Quartile <span class="math inline">\(-\)</span> (<span class="math inline">\(1.5\times\)</span> IQR)], and the [<span class="math inline">\(3^{rd}\)</span> Quartile <span class="math inline">\(+\)</span> (<span class="math inline">\(1.5\times\)</span> IQR)]. They are the lower and upper ranges of “normal” data (the points excluding outliers).</p>
<p>The different forms of information contained in a box plot can be summarised as follows:</p>
<center>
<img src="images/box_plot_diagram_updated_2.png" width="600" alt="An annotated boxplot showing outliers, whiskers, and quartiles.">
</center>
</section>
<section id="side-by-side-box-plots" class="level3">
<h3 class="anchored" data-anchor-id="side-by-side-box-plots">Side-by-Side Box plots</h3>
<p>Plotting side-by-side box plots allows us to compare distributions across different categories. In other words, they enable us to plot both a qualitative variable and a quantitative variable in one visualization.</p>
<p>With <code>seaborn</code>, we can easily create side-by-side plots by specifying both an x and y column.</p>
<p>In the example below, we plot the distribution of a quantitative variable, GDP % growth, across different categories, which are different continents in this case</p>
<div id="227497ff" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>wb, x<span class="op">=</span><span class="st">"Continent"</span>, y<span class="op">=</span><span class="st">'Gross domestic product: </span><span class="sc">% g</span><span class="st">rowth : 2016'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-20-output-1.png" alt="Example of side-by-side box plots. On the x-axis is the Continent with separate box plots per continent. Each continent box plot shares the same y-axis leading to easy comparison." width="596" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="violin-plots" class="level3">
<h3 class="anchored" data-anchor-id="violin-plots">Violin Plots</h3>
<p>Violin plots are just box plots with smoothed density curves. The width indicates the density of points. Q1, the median, Q3, and whiskers are still present, just harder to see at first.</p>
<div id="a6b95f54" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sns.violinplot(data<span class="op">=</span>wb, y<span class="op">=</span><span class="st">"Gross national income per capita, Atlas method: $: 2016"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-21-output-1.png" alt="Example violin plot." width="618" height="396" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Look closely at the center vertical bar of the violin plot above; the three quartiles and “whiskers” are still present!</p>
<p>Important note about Violin plots:</p>
<details>
<summary>
Can violin plots or box plots display modality?
</summary>
<p>Violin plots <strong>can</strong> display modality, and box plots <strong>cannot</strong>! The distribution in the violin plot above is (arguably) multimodal. We see one peak/mode around the median, and two others at higher values.You cannot tell this from a boxplot of the same information alone (We plotted this same distribution as a box plot earlier in these notes).</p>
<center>
<img src="images/box_vs_violin_width.png" width="600" alt="The same data is plotted twice, on the left with a box plot and on the right with a violin plot.">
</center>
<p>Observe that the width of a box in a box plot has no meaning, but the width in a violin plot is meaningful, and gives us information about the density of data points at a given range of values!</p>
<p>Since a violin plot contains all the information that a box plot, as well as information about modality/density of points, you may wonder why we still use box plots. The choice between a box plot and a violin plot will depend on if the density of points is useful information about the distribution you’re trying to visualize. If the density of points is not useful information, it can distract from information you are trying to highlight about the distribution.</p>
</details>
</section>
</section>
<section id="kernel-density-estimation" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-estimation">Kernel Density Estimation</h2>
<p>Often, we want to identify general trends across a distribution, rather than focus on detail. Smoothing a distribution helps generalize the structure of the data and eliminate noise.</p>
<section id="kde-theory" class="level3">
<h3 class="anchored" data-anchor-id="kde-theory">KDE Theory</h3>
<p>A <strong>kernel density estimate (KDE)</strong> is a smooth, continuous function that approximates a curve. It allows us to represent general trends in a distribution without focusing on the details, which is useful for analyzing the broad structure of a dataset.</p>
<p>More formally, a KDE attempts to approximate the underlying <strong>probability distribution</strong> from which our dataset was drawn. You may have encountered the idea of a probability distribution in your other classes; if not, we’ll discuss it at length in the next lecture. For now, you can think of a probability distribution as a description of how likely it is for us to sample a particular value in our dataset.</p>
<p>A KDE curve estimates the probability density function of a random variable. Consider the example below, where we have used <code>sns.displot</code> to plot both a histogram (containing the data points we actually collected) and a KDE curve (representing the <em>approximated</em> probability distribution from which this data was drawn) using data from the World Bank dataset (<code>wb</code>).</p>
<div id="a03ce393" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, <span class="st">"use_inf_as_na"</span>) <span class="co"># Supresses distracting deprecation warnings</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>wb <span class="op">=</span> pd.read_csv(<span class="st">"data/world_bank.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>wb <span class="op">=</span> wb.rename(columns<span class="op">=</span>{<span class="st">'Antiretroviral therapy coverage: </span><span class="sc">% o</span><span class="st">f people living with HIV: 2015'</span>:<span class="st">"HIV rate"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'Gross national income per capita, Atlas method: $: 2016'</span>:<span class="st">'gni'</span>})</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>wb.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Continent</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Primary completion rate: Male: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Primary completion rate: Female: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Lower secondary completion rate: Male: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Lower secondary completion rate: Female: % of relevant age group: 2015</th>
<th data-quarto-table-cell-role="th">Youth literacy rate: Male: % of ages 15-24: 2005-14</th>
<th data-quarto-table-cell-role="th">Youth literacy rate: Female: % of ages 15-24: 2005-14</th>
<th data-quarto-table-cell-role="th">Adult literacy rate: Male: % ages 15 and older: 2005-14</th>
<th data-quarto-table-cell-role="th">Adult literacy rate: Female: % ages 15 and older: 2005-14</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Access to improved sanitation facilities: % of population: 1990</th>
<th data-quarto-table-cell-role="th">Access to improved sanitation facilities: % of population: 2015</th>
<th data-quarto-table-cell-role="th">Child immunization rate: Measles: % of children ages 12-23 months: 2015</th>
<th data-quarto-table-cell-role="th">Child immunization rate: DTP3: % of children ages 12-23 months: 2015</th>
<th data-quarto-table-cell-role="th">Children with acute respiratory infection taken to health provider: % of children under age 5 with ARI: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children with diarrhea who received oral rehydration and continuous feeding: % of children under age 5 with diarrhea: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children sleeping under treated bed nets: % of children under age 5: 2009-2016</th>
<th data-quarto-table-cell-role="th">Children with fever receiving antimalarial drugs: % of children under age 5 with fever: 2009-2016</th>
<th data-quarto-table-cell-role="th">Tuberculosis: Treatment success rate: % of new cases: 2014</th>
<th data-quarto-table-cell-role="th">Tuberculosis: Cases detection rate: % of new estimated cases: 2015</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Africa</td>
<td>Algeria</td>
<td>106.0</td>
<td>105.0</td>
<td>68.0</td>
<td>85.0</td>
<td>96.0</td>
<td>92.0</td>
<td>83.0</td>
<td>68.0</td>
<td>...</td>
<td>80.0</td>
<td>88.0</td>
<td>95.0</td>
<td>95.0</td>
<td>66.0</td>
<td>42.0</td>
<td>NaN</td>
<td>NaN</td>
<td>88.0</td>
<td>80.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Africa</td>
<td>Angola</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>79.0</td>
<td>67.0</td>
<td>82.0</td>
<td>60.0</td>
<td>...</td>
<td>22.0</td>
<td>52.0</td>
<td>55.0</td>
<td>64.0</td>
<td>NaN</td>
<td>NaN</td>
<td>25.9</td>
<td>28.3</td>
<td>34.0</td>
<td>64.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Africa</td>
<td>Benin</td>
<td>83.0</td>
<td>73.0</td>
<td>50.0</td>
<td>37.0</td>
<td>55.0</td>
<td>31.0</td>
<td>41.0</td>
<td>18.0</td>
<td>...</td>
<td>7.0</td>
<td>20.0</td>
<td>75.0</td>
<td>79.0</td>
<td>23.0</td>
<td>33.0</td>
<td>72.7</td>
<td>25.9</td>
<td>89.0</td>
<td>61.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Africa</td>
<td>Botswana</td>
<td>98.0</td>
<td>101.0</td>
<td>86.0</td>
<td>87.0</td>
<td>96.0</td>
<td>99.0</td>
<td>87.0</td>
<td>89.0</td>
<td>...</td>
<td>39.0</td>
<td>63.0</td>
<td>97.0</td>
<td>95.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>77.0</td>
<td>62.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Africa</td>
<td>Burundi</td>
<td>58.0</td>
<td>66.0</td>
<td>35.0</td>
<td>30.0</td>
<td>90.0</td>
<td>88.0</td>
<td>89.0</td>
<td>85.0</td>
<td>...</td>
<td>42.0</td>
<td>48.0</td>
<td>93.0</td>
<td>94.0</td>
<td>55.0</td>
<td>43.0</td>
<td>53.8</td>
<td>25.4</td>
<td>91.0</td>
<td>51.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 47 columns</p>
</div>
</div>
</div>
<div id="f67bdf90" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>sns.displot(data <span class="op">=</span> wb, x <span class="op">=</span> <span class="st">'HIV rate'</span>, <span class="op">\</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                       kde <span class="op">=</span> <span class="va">True</span>, stat <span class="op">=</span> <span class="st">"density"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of HIV rates"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-23-output-1.png" alt="Plot titled 'Distribution of HIV rates' with both the histogram and KDE plotted" width="470" height="490" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice that the smooth KDE curve is higher when the histogram bins are taller. You can think of the height of the KDE curve as representing how “probable” it is that we randomly sample a datapoint with the corresponding value. This intuitively makes sense – if we have already collected more datapoints with a particular value (resulting in a tall histogram bin), it is more likely that, if we randomly sample another datapoint, we will sample one with a similar value (resulting in a high KDE curve).</p>
<p>The area under a probability density function should always integrate to 1, representing the fact that the total probability of a distribution should always sum to 100%. Hence, a KDE curve will always have an area under the curve of 1.</p>
</section>
<section id="constructing-a-kde" class="level3">
<h3 class="anchored" data-anchor-id="constructing-a-kde">Constructing a KDE</h3>
<p>We perform kernel density estimation using three steps.</p>
<ol type="1">
<li>Place a kernel at each datapoint.</li>
<li>Normalize the kernels to have a total area of 1 (across all kernels).</li>
<li>Sum the normalized kernels.</li>
</ol>
<p>We’ll explain what a “kernel” is momentarily.</p>
<p>To make things simpler, let’s construct a KDE for a small, artificially generated dataset of 5 datapoints: <span class="math inline">\([2.2, 2.8, 3.7, 5.3, 5.7]\)</span>. In the plot below, each vertical bar represents one data point.</p>
<div id="736ee03f" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="fl">2.2</span>, <span class="fl">2.8</span>, <span class="fl">3.7</span>, <span class="fl">5.3</span>, <span class="fl">5.7</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>sns.rugplot(data, height<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Data"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">0.5</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-24-output-1.png" alt="Rug plot of the five datapoints in our artifically generated dataset. The points are between 2 and 6." width="597" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Our goal is to create the following KDE curve, which was generated automatically by <code>sns.kdeplot</code>.</p>
<div id="11660b5d" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Data"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data, bw_method<span class="op">=</span><span class="fl">0.65</span>) </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>sns.histplot(data, stat<span class="op">=</span><span class="st">'density'</span>, bins<span class="op">=</span><span class="dv">2</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-25-output-1.png" alt="Plot showing both the histogram and KDE" width="597" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Alternatively, we can use <code>sns.histplot</code>. You can also get a very similar result in a single call by requesting the KDE be added to the histogram, with <code>kde=True</code> and some extra keywords:</p>
<div id="bfca1e57" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Data"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>sns.histplot(data, bins<span class="op">=</span><span class="dv">2</span>, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>, kde_kws<span class="op">=</span><span class="bu">dict</span>(cut<span class="op">=</span><span class="dv">3</span>, bw_method<span class="op">=</span><span class="fl">0.65</span>))<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-26-output-1.png" alt="The same plot with the histogram and KDE, this time created using seaborn" width="597" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="step-1-place-a-kernel-at-each-data-point" class="level4">
<h4 class="anchored" data-anchor-id="step-1-place-a-kernel-at-each-data-point">Step 1: Place a Kernel at Each Data Point</h4>
<p>To begin generating a density curve, we need to choose a <strong>kernel</strong> and <strong>bandwidth value (<span class="math inline">\(\alpha\)</span>)</strong>. What are these exactly?</p>
<p>A <strong>kernel</strong> is a density curve. It is the mathematical function that attempts to capture the randomness of each data point in our sampled data. To explain what this means, consider just <em>one</em> of the datapoints in our dataset: <span class="math inline">\(2.2\)</span>. We obtained this datapoint by randomly sampling some information out in the real world (you can imagine <span class="math inline">\(2.2\)</span> as representing a single measurement taken in an experiment, for example). If we were to sample a new datapoint, we may obtain a slightly different value. It could be higher than <span class="math inline">\(2.2\)</span>; it could also be lower than <span class="math inline">\(2.2\)</span>. We make the assumption that any future sampled datapoints will likely be similar in value to the data we’ve already drawn. This means that our <em>kernel</em> – our description of the probability of randomly sampling any new value – will be greatest at the datapoint we’ve already drawn but still have non-zero probability above and below it. The area under any kernel should integrate to 1, representing the total probability of drawing a new datapoint.</p>
<p>A <strong>bandwidth value</strong>, usually denoted by <span class="math inline">\(\alpha\)</span>, represents the width of the kernel. A large value of <span class="math inline">\(\alpha\)</span> will result in a wide, short kernel function, while a small value with result in a narrow, tall kernel.</p>
<p>Below, we place a <strong>Gaussian kernel</strong>, plotted in orange, over the datapoint <span class="math inline">\(2.2\)</span>. A Gaussian kernel is simply the normal distribution, which you may have called a bell curve in Data 8.</p>
<div id="bfeac142" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gaussian_kernel(x, z, a):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We'll discuss where this mathematical formulation came from later</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span><span class="op">/</span>np.sqrt(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>a<span class="op">**</span><span class="dv">2</span>)) <span class="op">*</span> np.exp((<span class="op">-</span>(x <span class="op">-</span> z)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> a<span class="op">**</span><span class="dv">2</span>)))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot our datapoint</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>sns.rugplot([<span class="fl">2.2</span>], height<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the kernel</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, gaussian_kernel(x, <span class="fl">2.2</span>, <span class="dv">1</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Data"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">0.5</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-27-output-1.png" alt="A Gaussian kernel is plotted over one of the datapoints in the artificially generated dataset." width="597" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To begin creating our KDE, we place a kernel on <em>each</em> datapoint in our dataset. For our dataset of 5 points, we will have 5 kernels.</p>
<div id="502e2336" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You will work with the functions below in Lab 4</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_kde(kernel, pts, a):</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Takes in a kernel, set of points, and alpha</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Returns the KDE as a function</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> f(x):</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> pt <span class="kw">in</span> pts:</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>            output <span class="op">+=</span> kernel(x, pt, a)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output <span class="op">/</span> <span class="bu">len</span>(pts) <span class="co"># Normalization factor</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_kde(kernel, pts, a):</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calls create_kde and plots the corresponding KDE</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> create_kde(kernel, pts, a)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(<span class="bu">min</span>(pts) <span class="op">-</span> <span class="dv">5</span>, <span class="bu">max</span>(pts) <span class="op">+</span> <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> [f(xi) <span class="cf">for</span> xi <span class="kw">in</span> x]</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, y)<span class="op">;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_separate_kernels(kernel, pts, a, norm<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plots individual kernels, which are then summed to create the KDE</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(<span class="bu">min</span>(pts) <span class="op">-</span> <span class="dv">5</span>, <span class="bu">max</span>(pts) <span class="op">+</span> <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pt <span class="kw">in</span> pts:</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> kernel(x, pt, a)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> norm:</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>            y <span class="op">/=</span> <span class="bu">len</span>(pts)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        plt.plot(x, y)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    plt.show()<span class="op">;</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Data"</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>plot_separate_kernels(gaussian_kernel, data, a <span class="op">=</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-28-output-1.png" alt="A Gaussian kernel is plotted over all of the datapoints in the artificially generated dataset." width="597" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-2-normalize-kernels-to-have-a-total-area-of-1" class="level4">
<h4 class="anchored" data-anchor-id="step-2-normalize-kernels-to-have-a-total-area-of-1">Step 2: Normalize Kernels to Have a Total Area of 1</h4>
<p>Above, we said that <em>each</em> kernel has an area of 1. Earlier, we also said that our goal is to construct a KDE curve using these kernels with a <em>total</em> area of 1. If we were to directly sum the kernels as they are, we would produce a KDE curve with an integrated area of (5 kernels) <span class="math inline">\(\times\)</span> (area of 1 each) = 5. To avoid this, we will <strong>normalize</strong> each of our kernels. This involves multiplying each kernel by <span class="math inline">\(\frac{1}{\#\:\text{datapoints}}\)</span>.</p>
<p>In the cell below, we multiply each of our 5 kernels by <span class="math inline">\(\frac{1}{5}\)</span> to apply normalization.</p>
<div id="c06c7d88" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Data"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The `norm` argument specifies whether or not to normalize the kernels</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>plot_separate_kernels(gaussian_kernel, data, a <span class="op">=</span> <span class="dv">1</span>, norm <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-29-output-1.png" alt="A Gaussian kernel is plotted over all of the datapoints in the artificially generated dataset. The kernels have been normalized, so they are more stout than in the previous plot" width="597" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-3-sum-the-normalized-kernels" class="level4">
<h4 class="anchored" data-anchor-id="step-3-sum-the-normalized-kernels">Step 3: Sum the Normalized Kernels</h4>
<p>Our KDE curve is the sum of the normalized kernels. Notice that the final curve is identical to the plot generated by <code>sns.kdeplot</code> we saw earlier!</p>
<div id="c5e6df22" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Data"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plot_kde(gaussian_kernel, data, a<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-30-output-1.png" alt="The KDE plotted." width="597" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that it would be equivalent to sum the kernels and then normalize the result.</p>
</section>
</section>
<section id="mathematical-notation-of-kde" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-notation-of-kde">Mathematical Notation of KDE</h3>
<center>
<img src="images/kde_function.png" width="345" alt="KDE formula">
</center>
<p>A general “KDE formula” function is given above.</p>
<ol type="1">
<li><p><span class="math inline">\(f_{\alpha}(x)\)</span> is the end result.<span class="math inline">\(\rightarrow\)</span> <strong>Height</strong> of the final KDE curve at any x-value.</p></li>
<li><p><span class="math inline">\(K_{\alpha}(x, x_i)\)</span> is tfhe kernel centered on the observation <code>i</code>.</p>
<ul>
<li>Each kernel individually has area 1.</li>
<li>x represents any number on the number line. It is the input to our function.</li>
</ul></li>
<li><p><span class="math inline">\(n\)</span> is the number of observed datapoints that we have.</p>
<ul>
<li>We multiply by <span class="math inline">\(\frac{1}{n}\)</span> so that the total area of the KDE is still 1.</li>
</ul></li>
<li><p>Each <span class="math inline">\(x_i \in \{x_1, x_2, \dots, x_n\}\)</span> represents an observed datapoint.</p>
<ul>
<li>These are what we use to create our KDE by summing multiple shifted kernels centered at these points.</li>
</ul></li>
</ol>
<ul>
<li><span class="math inline">\(\alpha\)</span> (alpha) is the bandwidth or smoothing parameter.</li>
</ul>
<p>A <strong>kernel</strong> (for our purposes) is a valid density function. This means it:</p>
<ul>
<li>Must be non-negative for all inputs.</li>
<li>Must integrate to 1.</li>
</ul>
<section id="gaussian-kernel" class="level4">
<h4 class="anchored" data-anchor-id="gaussian-kernel">Gaussian Kernel</h4>
<p>The most common kernel is the <strong>Gaussian kernel</strong>. The Gaussian kernel is equivalent to the Gaussian probability density function (the Normal distribution), centered at the observed value with a standard deviation of <span class="math inline">\(\alpha\)</span> (this is known as the <strong>bandwidth</strong> parameter).</p>
<p><span class="math display">\[K_a(x, x_i) = \frac{1}{\sqrt{2\pi\alpha^{2}}}e^{-\frac{(x-x_i)^{2}}{2\alpha^{2}}}\]</span></p>
<p>In this formula:</p>
<ul>
<li><span class="math inline">\(x\)</span> (no subscript) represents any value along the x-axis of our plot</li>
<li><span class="math inline">\(x_i\)</span> represents the <span class="math inline">\(i\)</span> -th datapoint in our dataset. It is one of the values that we have actually collected in our data sampling process. In our example earlier, <span class="math inline">\(x_i=2.2\)</span>. Those of you who have taken a probability class may recognize <span class="math inline">\(x_i\)</span> as the <strong>mean</strong> of the normal distribution.</li>
<li>Each kernel is <strong>centered</strong> on our observed values, so its distribution mean is <span class="math inline">\(x_i\)</span>.</li>
<li><span class="math inline">\(\alpha\)</span> is the bandwidth parameter, representing the width of our kernel. More formally, <span class="math inline">\(\alpha\)</span> is the <strong>standard deviation</strong> of the Gaussian curve.
<ul>
<li>A large value of <span class="math inline">\(\alpha\)</span> will produce a kernel that is wider and shorter – this leads to a smoother KDE when the kernels are summed together.</li>
<li>A small value of <span class="math inline">\(\alpha\)</span> will produce a narrower, taller kernel, and, with it, a noisier KDE.</li>
</ul></li>
</ul>
<p>The details of this (admittedly intimidating) formula are less important than understanding its role in kernel density estimation – this equation gives us the shape of each kernel.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Gaussian Kernel, <span class="math inline">\(\alpha\)</span> = 0.1</th>
<th>Gaussian Kernel, <span class="math inline">\(\alpha\)</span> = 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="images/gaussian_0.1.png" alt="Gaussian kernel with alpha=0.1" width="345"></td>
<td><img src="images/gaussian_1.png" alt="Gaussian kernel with alpha=1" width="345"></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Gaussian Kernel, <span class="math inline">\(\alpha\)</span> = 2</th>
<th>Gaussian Kernel, <span class="math inline">\(\alpha\)</span> = 5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="images/gaussian_2.png" alt="Gaussian kernel with alpha=2" width="345"></td>
<td><img src="images/gaussian_5.png" alt="Gaussian kernel with alpha=5" width="345"></td>
</tr>
</tbody>
</table>
</section>
<section id="boxcar-kernel" class="level4">
<h4 class="anchored" data-anchor-id="boxcar-kernel">Boxcar Kernel</h4>
<p>Another example of a kernel is the <strong>Boxcar kernel</strong>. The boxcar kernel assigns a uniform density to points within a “window” of the observation, and a density of 0 elsewhere. The equation below is a boxcar kernel with the center at <span class="math inline">\(x_i\)</span> and the bandwidth of <span class="math inline">\(\alpha\)</span>.</p>
<p><span class="math display">\[K_a(x, x_i) = \begin{cases}
        \frac{1}{\alpha}, &amp; |x - x_i| \le \frac{\alpha}{2}\\
        0, &amp; \text{else }
    \end{cases}\]</span></p>
<p>The boxcar kernel is seldom used in practice – we include it here to demonstrate that a kernel function can take whatever form you would like, provided it integrates to 1 and does not output negative values.</p>
<div id="87739fac" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> boxcar_kernel(alpha, x, z):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (((x<span class="op">-</span>z)<span class="op">&gt;=-</span>alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">&amp;</span>((x<span class="op">-</span>z)<span class="op">&lt;=</span>alpha<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>alpha</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">200</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="dv">1</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>kde_curve <span class="op">=</span> [boxcar_kernel(alpha, x, <span class="dv">0</span>) <span class="cf">for</span> x <span class="kw">in</span> xs]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.plot(xs, kde_curve)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="visualization_1_files/figure-html/cell-31-output-1.png" alt="The Boxcar kernel centered at 0 with bandwidth $\alpha$ = 1." width="571" height="411" class="figure-img"></p>
<figcaption>The Boxcar kernel centered at 0 with bandwidth <span class="math inline">\(\alpha\)</span> = 1.</figcaption>
</figure>
</div>
</div>
</div>
<p>The diagram on the right is how the density curve for our 5 point dataset would have looked had we used the Boxcar kernel with bandwidth <span class="math inline">\(\alpha\)</span> = 1.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>KDE</th>
<th>Boxcar</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="images/gaussian_kernel.png" alt="KDE of toy data with Gaussian kernel and alpha=1." width="350"></td>
<td><img src="images/boxcar_kernel.png" alt="KDE of toy data with Boxcar kernel and alpha=1." width="350"></td>
</tr>
</tbody>
</table>
<p>We’ll continue covering visualization in the next lecture!</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
    // 1. Select the specific parent div within the callout header that has the 
    //    collapse attributes (data-bs-toggle).
    var calloutToggles = document.querySelectorAll(
        '.callout-header[data-bs-toggle="collapse"]'
    );

    calloutToggles.forEach(function(toggle) {
        // 2. Force the ARIA role to be 'button'
        // This is crucial because a 'div' is not allowed to use aria-expanded.
        toggle.setAttribute('role', 'button');
        
        // 3. Ensure it is keyboard-focusable (critical accessibility fix)
        if (toggle.getAttribute('tabindex') === null) {
             toggle.setAttribute('tabindex', '0');
        }
    });

    // Scrollable Region Accessibility Fix:
    // Target ALL <pre> elements, as they are the source of the scrollable-region-focusable errors.
    var scrollableRegions = document.querySelectorAll('pre'); 

    scrollableRegions.forEach(function(region) {
        // Check if the element has horizontal overflow (is scrollable).
        const hasScrollbar = region.scrollWidth > region.clientWidth || region.scrollHeight > region.clientHeight;

        if (hasScrollbar) {
            // If it is scrollable AND it doesn't already have tabindex="0" (or a different value)
            if (region.getAttribute('tabindex') === null || region.getAttribute('tabindex') === undefined) {
                    region.setAttribute('tabindex', '0');
            }
        }
    });
});
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ds100\.org\/course-notes\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>