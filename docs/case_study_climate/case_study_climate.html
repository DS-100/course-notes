<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Principles and Techniques of Data Science - 19&nbsp; Case Study in Climate and Physical Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../inference_causality/inference_causality.html" rel="next">
<link href="../case_study_HCE/case_study_HCE.html" rel="prev">
<link href="../data100_logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Case Study in Climate and Physical Data</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../data100_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Principles and Techniques of Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/DS-100/course-notes" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="../Principles-and-Techniques-of-Data-Science.pdf" title="Download PDF" class="sidebar-tool px-1"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_lec/introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas_1/pandas_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Pandas I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas_2/pandas_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Pandas II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas_3/pandas_3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Pandas III</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../eda/eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Cleaning and EDA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regex/regex.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regular Expressions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../visualization_1/visualization_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualization I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../visualization_2/visualization_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualization II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sampling/sampling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Sampling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_to_modeling/intro_to_modeling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../constant_model_loss_transformations/loss_transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Constant Model, Loss, and Transformations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ols/ols.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Ordinary Least Squares</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gradient_descent/gradient_descent.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Gradient Descent</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../feature_engineering/feature_engineering.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Feature Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cv_regularization/cv_reg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Cross Validation and Regularization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability_1/probability_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Probability I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability_2/probability_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Probability II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../case_study_HCE/case_study_HCE.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Case Study in Human Contexts and Ethics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../case_study_climate/case_study_climate.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Case Study in Climate and Physical Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../inference_causality/inference_causality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inference &amp; Causality</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Case Study in Climate and Physical Data</h2>
   
  <ul>
  <li><a href="#the-greenhouse-effect" id="toc-the-greenhouse-effect" class="nav-link active" data-scroll-target="#the-greenhouse-effect"><span class="toc-section-number">19.1</span>  The Greenhouse Effect</a>
  <ul>
  <li><a href="#keeling-curve" id="toc-keeling-curve" class="nav-link" data-scroll-target="#keeling-curve"><span class="toc-section-number">19.1.1</span>  Keeling Curve</a></li>
  <li><a href="#calculating-the-greenhouse-effect" id="toc-calculating-the-greenhouse-effect" class="nav-link" data-scroll-target="#calculating-the-greenhouse-effect"><span class="toc-section-number">19.1.2</span>  Calculating the Greenhouse Effect</a></li>
  <li><a href="#additional-words-on-the-severity-of-climate-change" id="toc-additional-words-on-the-severity-of-climate-change" class="nav-link" data-scroll-target="#additional-words-on-the-severity-of-climate-change"><span class="toc-section-number">19.1.3</span>  Additional Words on the Severity of Climate Change</a></li>
  </ul></li>
  <li><a href="#era5-and-xarray" id="toc-era5-and-xarray" class="nav-link" data-scroll-target="#era5-and-xarray"><span class="toc-section-number">19.2</span>  ERA5 and Xarray</a>
  <ul>
  <li><a href="#era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses" id="toc-era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses" class="nav-link" data-scroll-target="#era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses"><span class="toc-section-number">19.2.1</span>  ERA5 - 5th gen ECMWF atmospheric global climate ReAnalyses</a></li>
  <li><a href="#working-with-xarray" id="toc-working-with-xarray" class="nav-link" data-scroll-target="#working-with-xarray"><span class="toc-section-number">19.2.2</span>  Working with Xarray</a>
  <ul>
  <li><a href="#xarray-dataset" id="toc-xarray-dataset" class="nav-link" data-scroll-target="#xarray-dataset"><span class="toc-section-number">19.2.2.1</span>  Xarray: Dataset</a></li>
  <li><a href="#xarray-read-in-dataset" id="toc-xarray-read-in-dataset" class="nav-link" data-scroll-target="#xarray-read-in-dataset"><span class="toc-section-number">19.2.2.2</span>  Xarray: Read in Dataset</a></li>
  <li><a href="#coordinates-vs.-dimensions" id="toc-coordinates-vs.-dimensions" class="nav-link" data-scroll-target="#coordinates-vs.-dimensions"><span class="toc-section-number">19.2.2.3</span>  Coordinates vs.&nbsp;Dimensions</a></li>
  <li><a href="#dataarrays-are-data-variables-in-a-dataset" id="toc-dataarrays-are-data-variables-in-a-dataset" class="nav-link" data-scroll-target="#dataarrays-are-data-variables-in-a-dataset"><span class="toc-section-number">19.2.2.4</span>  DataArrays are Data Variables in a Dataset</a></li>
  <li><a href="#dataarray-access-sel-isel" id="toc-dataarray-access-sel-isel" class="nav-link" data-scroll-target="#dataarray-access-sel-isel"><span class="toc-section-number">19.2.2.5</span>  DataArray Access: , sel, isel</a></li>
  <li><a href="#methods-can-be-called-across-a-dataarray-or-a-dataset" id="toc-methods-can-be-called-across-a-dataarray-or-a-dataset" class="nav-link" data-scroll-target="#methods-can-be-called-across-a-dataarray-or-a-dataset"><span class="toc-section-number">19.2.2.6</span>  Methods can be called across a DataArray or a Dataset</a></li>
  <li><a href="#weighing-data-using-xarray" id="toc-weighing-data-using-xarray" class="nav-link" data-scroll-target="#weighing-data-using-xarray"><span class="toc-section-number">19.2.2.7</span>  Weighing Data Using Xarray</a></li>
  <li><a href="#plotting-temperature-trend-with-respect-to-locatoin" id="toc-plotting-temperature-trend-with-respect-to-locatoin" class="nav-link" data-scroll-target="#plotting-temperature-trend-with-respect-to-locatoin"><span class="toc-section-number">19.2.2.8</span>  Plotting Temperature Trend with Respect to Locatoin</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="toc-section-number">19.3</span>  Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Case Study in Climate and Physical Data</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Learning Outcomes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>See an example of how may of the tools we’ve been developing in this class can be applied to understand climate data.</li>
<li>Gain a basic of understanding of how to use the Xarray python library.</li>
</ul>
</div>
</div>
</div>
<section id="the-greenhouse-effect" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="the-greenhouse-effect"><span class="header-section-number">19.1</span> The Greenhouse Effect</h2>
<p>The Greenhouse Effect is the foundation of climate change.</p>
<p><img src="images/slide18.png" width="700"></p>
<section id="keeling-curve" class="level3" data-number="19.1.1">
<h3 data-number="19.1.1" class="anchored" data-anchor-id="keeling-curve"><span class="header-section-number">19.1.1</span> Keeling Curve</h3>
<p>In 1958 Keeling got a grant to begin monitoring CO2 in Hawaii. Roger Revelle (a famous scientist) argued that because CO2 was too variable, they just needed a snapshot at that time and another snapshot 20 years later to show that CO2 was increasing. Keeling advocated for precise measurements over time. By the mid-1960s we had both a measurement of the Earth’s breathing and the global increase in CO2.</p>
<p>How would you remake this figure?</p>
<p><img src="images/slide10.png" width="700"></p>
</section>
<section id="calculating-the-greenhouse-effect" class="level3" data-number="19.1.2">
<h3 data-number="19.1.2" class="anchored" data-anchor-id="calculating-the-greenhouse-effect"><span class="header-section-number">19.1.2</span> Calculating the Greenhouse Effect</h3>
<p><strong>Goal</strong>: Calculate how the Earth’s temperature is changing with increasing CO2.</p>
<p>The planetary energy balance: Energy absorbed (from the Sun) = Energy emitted (by the Earth)</p>
<p>How does CO2 affect the planetary energy balance? 1. The Sun emits radiation that is absorbed by the Earth (though roughly 30% of the energy the sun radiates is reflected by clouds, ice/snow, deserts, etc.. The fraction of radiation from the Sun that gets reflected back to space by the atmosphere is called <strong>albedo</strong>) 2. The Earth emits radiation according to Stephen-Bolzman’s Law: the rate that a body emits radiation (per unit area) is directly proportional to the body’s absolute temperature to the fourth power (blackbody radiation). 3. The emitted radiation doesn’t all go back into space …</p>
<p>Our atmosphere is like a blanket, it traps some energy.</p>
<p><img src="images/slide19.png" width="700"></p>
<p>Using this equation we can calculate the increase in temperature with time due to the increase in CO2.</p>
<p><img src="images/slide21.png" width="700"></p>
</section>
<section id="additional-words-on-the-severity-of-climate-change" class="level3" data-number="19.1.3">
<h3 data-number="19.1.3" class="anchored" data-anchor-id="additional-words-on-the-severity-of-climate-change"><span class="header-section-number">19.1.3</span> Additional Words on the Severity of Climate Change</h3>
<p>From the Intergovernmental Panel on Climate Change (IPOC): “Recent changes in the climate are widespread, rapid, and intensifying, and unprecedented in thousands of years. Unless there are immediate, rapid, and large-scale reductions in greenhouse gas emissions, limiting warming to 1.5 C will be beyond reach. It is indisputable that human activities are causing climate change, making extreme climate events, including heat waves, heavy rainfall, and droughts more frequent and severe. However, some changes could be slowed and others stopped by limiting warming.”</p>
<p>With every increment of global warming, changes get larger:</p>
<p><img src="images/slide36.png" width="700"></p>
<p>A decade ago scientists would argue that we can’t attribute any single weather event to climate. In the last decade, we have all experienced major shifts in our climate through changes in our local weather and scientists have figured out ‘climate change attribution’.</p>
<p>They look at the probability of the occurence of an event (e.g.&nbsp;a temperature extreme) in models run without human-influence and them compare it to the probability in models run with human-influence.</p>
<p><img src="images/slide41.png" width="700"></p>
</section>
</section>
<section id="era5-and-xarray" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="era5-and-xarray"><span class="header-section-number">19.2</span> ERA5 and Xarray</h2>
<section id="era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses" class="level3" data-number="19.2.1">
<h3 data-number="19.2.1" class="anchored" data-anchor-id="era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses"><span class="header-section-number">19.2.1</span> ERA5 - 5th gen ECMWF atmospheric global climate ReAnalyses</h3>
<p>ERA5 combines vast amounts of historical observations into global estimates using advanced modeling and data assimilation systems. From 1979 - 2019, hourly estimates of atmospheric, land and oceanic climate variables were taken. The number of observations assimilated in ERA5 has increased from approximately 0.75 million per day on average in 1979 to around 24 million per day by the end of 2018. It is a key dataset used for understanding our weather and climate, but it is accessible to only a few privileged institutions.</p>
<p><img src="images/slide52.png" width="700"></p>
</section>
<section id="working-with-xarray" class="level3" data-number="19.2.2">
<h3 data-number="19.2.2" class="anchored" data-anchor-id="working-with-xarray"><span class="header-section-number">19.2.2</span> Working with Xarray</h3>
<section id="xarray-dataset" class="level4" data-number="19.2.2.1">
<h4 data-number="19.2.2.1" class="anchored" data-anchor-id="xarray-dataset"><span class="header-section-number">19.2.2.1</span> Xarray: Dataset</h4>
<p>Xarray Datasets are essentially groups of DataArrays. This is <strong>really</strong> valuable when you are looking at datasets that have multidimensional groups of data (e.g.&nbsp;temperature, cloud cover). Some Xarray methods can be applied to all that Dataset contains. For example, you can subset a Dataset and the subset, interpolate, calculate a mean, and it will do this across all the DataArrays the Dataset contains.</p>
</section>
<section id="xarray-read-in-dataset" class="level4" data-number="19.2.2.2">
<h4 data-number="19.2.2.2" class="anchored" data-anchor-id="xarray-read-in-dataset"><span class="header-section-number">19.2.2.2</span> Xarray: Read in Dataset</h4>
<p><img src="images/slide53.png" width="700"></p>
</section>
<section id="coordinates-vs.-dimensions" class="level4" data-number="19.2.2.3">
<h4 data-number="19.2.2.3" class="anchored" data-anchor-id="coordinates-vs.-dimensions"><span class="header-section-number">19.2.2.3</span> Coordinates vs.&nbsp;Dimensions</h4>
<p>DataArray objects inside a Dataset may have any number of dimensions but are presumed to share a common coordinate system. Coordinates can also have number of dimensions but denote constant/independent quantities, unlike the varying/dependent quantities that belong in data. A dimension is just a name of an axis, like “time”.</p>
<p><img src="images/slide55.png" width="700"></p>
</section>
<section id="dataarrays-are-data-variables-in-a-dataset" class="level4" data-number="19.2.2.4">
<h4 data-number="19.2.2.4" class="anchored" data-anchor-id="dataarrays-are-data-variables-in-a-dataset"><span class="header-section-number">19.2.2.4</span> DataArrays are Data Variables in a Dataset</h4>
<p>A DataArray holds multi-dimensional information. DataArray objects inside a Dataset may have any number of dimensions but are presumed to share a common coordinate system.</p>
<p>You can explore the data easily using either of the following syntax:</p>
<ol type="1">
<li>ds[“air_temperature_at_2_metres”]</li>
<li>ds.air_temperature_at_2_metres</li>
</ol>
</section>
<section id="dataarray-access-sel-isel" class="level4" data-number="19.2.2.5">
<h4 data-number="19.2.2.5" class="anchored" data-anchor-id="dataarray-access-sel-isel"><span class="header-section-number">19.2.2.5</span> DataArray Access: <a href="- Only used for DataArrays"></a>, sel, isel</h4>
<ol type="1">
<li><ul>
<li>Ex: point = ds_air_temperature_at_2_metres[0,26,119]</li>
</ul></li>
<li>isel: integer/positional
<ul>
<li>Always 0-based</li>
<li>Slices as usual, end-point exclusive</li>
<li>Ex: point = ds.isel(time = 0, latitude = 26, longitude = 119)</li>
</ul></li>
<li>sel: coordinates
<ul>
<li>Strings, integers (coordinates)</li>
<li>Slices: end-point inclusive!</li>
<li>Ex: point = ds.sel(time = “1979-01”, latitude = 37.125, longitude = 238.875)</li>
</ul></li>
</ol>
</section>
<section id="methods-can-be-called-across-a-dataarray-or-a-dataset" class="level4" data-number="19.2.2.6">
<h4 data-number="19.2.2.6" class="anchored" data-anchor-id="methods-can-be-called-across-a-dataarray-or-a-dataset"><span class="header-section-number">19.2.2.6</span> Methods can be called across a DataArray or a Dataset</h4>
<p>Select data and plot data in one line (using matplotlib)</p>
<p><img src="images/slide60.png" width="700"></p>
</section>
<section id="weighing-data-using-xarray" class="level4" data-number="19.2.2.7">
<h4 data-number="19.2.2.7" class="anchored" data-anchor-id="weighing-data-using-xarray"><span class="header-section-number">19.2.2.7</span> Weighing Data Using Xarray</h4>
<p>Xarrry provides the ability to weigh your data</p>
<p><img src="images/slide65.png" width="700"></p>
<p>Xarray methods like .weighted() can be combined with .mean() to create means across coordinates.</p>
<p><img src="images/slide66.png" width="700"></p>
<p>We can use .groupby() in combination with the above methods to calculate the annual temperature cycle.</p>
<p><img src="images/slide70.png" width="700"></p>
</section>
<section id="plotting-temperature-trend-with-respect-to-locatoin" class="level4" data-number="19.2.2.8">
<h4 data-number="19.2.2.8" class="anchored" data-anchor-id="plotting-temperature-trend-with-respect-to-locatoin"><span class="header-section-number">19.2.2.8</span> Plotting Temperature Trend with Respect to Locatoin</h4>
<p><img src="images/slide73.png" width="700"></p>
</section>
</section>
</section>
<section id="summary" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="summary"><span class="header-section-number">19.3</span> Summary</h2>
<ul>
<li>Xarray is a powerful tool to analyze climate data</li>
<li>The models use “parameterizations’, which are approximations for all sorts of different physical processes. Each parameterization uses coefficients derived from data science, but the experiments may be limited or imperfect. Often, parameters are adjusted to compensate for an error, but then end up causing other issues. This is still being worked on.</li>
<li>Society needs more data scientists working with climate and weather scientists to look at data similar to what was presented in this note. People like you can help to find new discoveries, amplify messages about changes to our climate and their impacts, and build machine learning models to replace old parameterizations.</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../case_study_HCE/case_study_HCE.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Case Study in Human Contexts and Ethics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../inference_causality/inference_causality.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inference &amp; Causality</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Case Study in Climate and Physical Data</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: Case Study in Climate and Physical Data</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">      - cosmo</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">      - cerulean</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">    callout-icon: false</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Outcomes</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>See an example of how may of the tools we've been developing in this class can be applied to understand climate data.</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Gain a basic of understanding of how to use the Xarray python library.</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Greenhouse Effect</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>The Greenhouse Effect is the foundation of climate change.</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide18.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span><span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">### Keeling Curve</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>In 1958 Keeling got a grant to begin monitoring CO2 in Hawaii. Roger Revelle (a famous scientist) argued that because CO2 was too variable, they just needed a snapshot at that time and another snapshot 20 years later to show that CO2 was increasing. Keeling advocated for precise measurements over time. By the mid-1960s we had both a measurement of the Earth's breathing and the global increase in CO2.</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>How would you remake this figure?</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide10.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span><span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating the Greenhouse Effect</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>**Goal**: Calculate how the Earth's temperature is changing with increasing CO2. </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>The planetary energy balance: Energy absorbed (from the Sun) = Energy emitted (by the Earth)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>How does CO2 affect the planetary energy balance?</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The Sun emits radiation that is absorbed by the Earth (though roughly 30% of the energy the sun radiates is reflected by clouds, ice/snow, deserts, etc.. The fraction of radiation from the Sun that gets reflected back to space by the atmosphere is called **albedo**)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The Earth emits radiation according to Stephen-Bolzman's Law: the rate that a body emits radiation (per unit area) is directly proportional to the body's absolute temperature to the fourth power (blackbody radiation).</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The emitted radiation doesn't all go back into space ...</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>Our atmosphere is like a blanket, it traps some energy. </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide19.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span><span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>Using this equation we can calculate the increase in temperature with time due to the increase in CO2. </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide21.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span><span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Additional Words on the Severity of Climate Change</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>From the Intergovernmental Panel on Climate Change (IPOC): "Recent changes in the climate are widespread, rapid, and intensifying, and unprecedented in thousands of years. Unless there are immediate, rapid, and large-scale reductions in greenhouse gas emissions, limiting warming to 1.5 C will be beyond reach. It is indisputable that human activities are causing climate change, making extreme climate events, including heat waves, heavy rainfall, and droughts more frequent and severe. However, some changes could be slowed and others stopped by limiting warming."</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>With every increment of global warming, changes get larger:</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide36.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span><span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>A decade ago scientists would argue that we can't attribute any single weather event to climate. In the last decade, we have all experienced major shifts in our climate through changes in our local weather and scientists have figured out 'climate change attribution'. </span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>They look at the probability of the occurence of an event (e.g. a temperature extreme) in models run without human-influence and them compare it to the probability in models run with human-influence. </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide41.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span><span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## ERA5 and Xarray</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### ERA5 - 5th gen ECMWF atmospheric global climate ReAnalyses</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>ERA5 combines vast amounts of historical observations into global estimates using advanced modeling and data assimilation systems. From 1979 - 2019, hourly estimates of atmospheric, land and oceanic climate variables were taken. The number of observations assimilated in ERA5 has increased from approximately 0.75 million per day on average in 1979 to around 24 million per day by the end of 2018. It is a key dataset used for understanding our weather and climate, but it is accessible to only a few privileged institutions. </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide52.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with Xarray</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Xarray: Dataset</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>Xarray Datasets are essentially groups of DataArrays. This is **really** valuable when you are looking at datasets that have multidimensional groups of data (e.g. temperature, cloud cover). Some Xarray methods can be applied to all that Dataset contains. For example, you can subset a Dataset and the subset, interpolate, calculate a mean, and it will do this across all the DataArrays the Dataset contains. </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Xarray: Read in Dataset</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide53.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Coordinates vs. Dimensions</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>DataArray objects inside a Dataset may have any number of dimensions but are presumed to share a common coordinate system. Coordinates can also have number of dimensions but denote constant/independent quantities, unlike the varying/dependent quantities that belong in data. A dimension is just a name of an axis, like "time".</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide55.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="fu">#### DataArrays are Data Variables in a Dataset</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>A DataArray holds multi-dimensional information. DataArray objects inside a Dataset may have any number of dimensions but are presumed to share a common coordinate system. </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>You can explore the data easily using either of the following syntax:</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>ds<span class="co">[</span><span class="ot">"air_temperature_at_2_metres"</span><span class="co">]</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>ds.air_temperature_at_2_metres</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="fu">#### DataArray Access: [ ], sel, isel</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>[]:</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Only used for DataArrays</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Ex: point = ds_air_temperature_at_2_metres<span class="co">[</span><span class="ot">0,26,119</span><span class="co">]</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>isel: integer/positional</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Always 0-based</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Slices as usual, end-point exclusive</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Ex: point = ds.isel(time = 0, latitude = 26, longitude = 119)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>sel: coordinates</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Strings, integers (coordinates)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Slices: end-point inclusive!</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Ex: point = ds.sel(time = "1979-01", latitude = 37.125, longitude = 238.875)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Methods can be called across a DataArray or a Dataset</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>Select data and plot data in one line (using matplotlib)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide60.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Weighing Data Using Xarray</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>Xarrry provides the ability to weigh your data</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide65.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>Xarray methods like .weighted() can be combined with .mean() to create means across coordinates. </span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide66.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>We can use .groupby() in combination with the above methods to calculate the annual temperature cycle.</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide70.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plotting Temperature Trend with Respect to Locatoin</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">"images/slide73.png"</span> <span class="er">width</span> <span class="ot">=</span> <span class="st">700</span> <span class="kw">&gt;&lt;/img&gt;&lt;/a&gt;</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Xarray is a powerful tool to analyze climate data</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>The models use "parameterizations', which are approximations for all sorts of different physical processes. Each parameterization uses coefficients derived from data science, but the experiments may be limited or imperfect. Often, parameters are adjusted to compensate for an error, but then end up causing other issues. This is still being worked on. </span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Society needs more data scientists working with climate and weather scientists to look at data similar to what was presented in this note. People like you can help to find new discoveries, amplify messages about changes to our climate and their impacts, and build machine learning models to replace old parameterizations.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>