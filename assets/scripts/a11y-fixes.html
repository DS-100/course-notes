<script>
    document.addEventListener("DOMContentLoaded", function() {
    // 1. Select the specific parent div within the callout header that has the 
    //    collapse attributes (data-bs-toggle).
    var calloutToggles = document.querySelectorAll(
        '.callout-header[data-bs-toggle="collapse"]'
    );

    calloutToggles.forEach(function(toggle) {
        // 2. Force the ARIA role to be 'button'
        // This is crucial because a 'div' is not allowed to use aria-expanded.
        toggle.setAttribute('role', 'button');
        
        // 3. Ensure it is keyboard-focusable (critical accessibility fix)
        if (toggle.getAttribute('tabindex') === null) {
             toggle.setAttribute('tabindex', '0');
        }
    });

    // Scrollable Region Accessibility Fix:
    const selectors = '.cell-output-display, .cell-output, pre, code';
    
    const fixScrollability = () => {
        const regions = document.querySelectorAll(selectors);
        regions.forEach(el => {
            const hasHorizontalScroll = el.scrollWidth > el.clientWidth;
            const hasVerticalScroll = el.scrollHeight > el.clientHeight;

            if (hasHorizontalScroll || hasVerticalScroll) {
                if (!el.hasAttribute('tabindex')) {
                    el.setAttribute('tabindex', '0');
                    // Add a label so screen readers explain why this is focusable
                    el.setAttribute('aria-label', 'Scrollable content');
                }
            }
        });
    };

    // Run once on load
    fixScrollability();

    // Run again if the window is resized (which might trigger scrollbars)
    window.addEventListener('resize', fixScrollability);
});
</script>