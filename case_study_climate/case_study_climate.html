<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Case Study in Climate and Physical Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="case_study_climate_files/libs/clipboard/clipboard.min.js"></script>
<script src="case_study_climate_files/libs/quarto-html/quarto.js"></script>
<script src="case_study_climate_files/libs/quarto-html/popper.min.js"></script>
<script src="case_study_climate_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="case_study_climate_files/libs/quarto-html/anchor.min.js"></script>
<link href="case_study_climate_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="case_study_climate_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="case_study_climate_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="case_study_climate_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="case_study_climate_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Case Study in Climate and Physical Data</h2>
   
  <ul>
  <li><a href="#the-greenhouse-effect" id="toc-the-greenhouse-effect" class="nav-link active" data-scroll-target="#the-greenhouse-effect">The Greenhouse Effect</a>
  <ul class="collapse">
  <li><a href="#keeling-curve" id="toc-keeling-curve" class="nav-link" data-scroll-target="#keeling-curve">Keeling Curve</a></li>
  <li><a href="#calculating-the-greenhouse-effect" id="toc-calculating-the-greenhouse-effect" class="nav-link" data-scroll-target="#calculating-the-greenhouse-effect">Calculating the Greenhouse Effect</a></li>
  <li><a href="#additional-words-on-the-severity-of-climate-change" id="toc-additional-words-on-the-severity-of-climate-change" class="nav-link" data-scroll-target="#additional-words-on-the-severity-of-climate-change">Additional Words on the Severity of Climate Change</a></li>
  </ul></li>
  <li><a href="#era5-and-xarray" id="toc-era5-and-xarray" class="nav-link" data-scroll-target="#era5-and-xarray">ERA5 and Xarray</a>
  <ul class="collapse">
  <li><a href="#era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses" id="toc-era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses" class="nav-link" data-scroll-target="#era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses">ERA5 - 5th gen ECMWF atmospheric global climate ReAnalyses</a></li>
  <li><a href="#working-with-xarray" id="toc-working-with-xarray" class="nav-link" data-scroll-target="#working-with-xarray">Working with Xarray</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Case Study in Climate and Physical Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Learning Outcomes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>See an example of how may of the tools we’ve been developing in this class can be applied to understand climate data.</li>
<li>Gain a basic of understanind of how to use the Xarray python library.</li>
</ul>
</div>
</div>
</div>
<section id="the-greenhouse-effect" class="level2">
<h2 class="anchored" data-anchor-id="the-greenhouse-effect">The Greenhouse Effect</h2>
<p>The Greenhouse Effect is the foundation of climate change.</p>
<p><img src="images/slide18.png" width="800"></p>
<section id="keeling-curve" class="level3">
<h3 class="anchored" data-anchor-id="keeling-curve">Keeling Curve</h3>
<p>In 1958 Keeling got a grant to begin monitoring CO2 in Hawaii. Roger Revelle (a famous scientist) argued that because CO2 was too variable, they just needed a snapshot at that time and another snapshot 20 years later to show that CO2 was increasing. Keeling advocated for precise measurements over time. By the mid-1960s we had both a measurement of the Earth’s breathing and the global increase in CO2.</p>
<p>How would you remake this figure?</p>
<p><img src="images/slide10.png" width="800"></p>
</section>
<section id="calculating-the-greenhouse-effect" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-greenhouse-effect">Calculating the Greenhouse Effect</h3>
<p><strong>Goal</strong>: Calculate how the Earth’s temperature is changing with increasing CO2.</p>
<p>The planetary energy balance: Energy absorbed (from the Sun) = Energy emitted (by the Earth)</p>
<p>How does CO2 affect the planetary energy balance? 1. The Sun emits radiation that is absorbed by the Earth (though roughly 30% of the energy the sun radiates is reflected by clouds, ice/snow, deserts, etc.. The fraction of radiation from the Sun that gets reflected back to space by the atmosphere is called <strong>albedo</strong>) 2. The Earth emits radiation according to Stephen-Bolzman’s Law: the rate that a body emits radiation (per unit area) is directly proportional to the body’s absolute temperature to the fourth power (blackbody radiation). 3. The emitted radiation doesn’t all go back into space …</p>
<p>Our atmosphere is like a blanket, it traps some energy.</p>
<p><img src="images/slide19.png" width="800"></p>
<p>Using this equation we can calculate the increase in temperature with time due to the increase in CO2.</p>
<p><img src="images/slide21.png" width="800"></p>
</section>
<section id="additional-words-on-the-severity-of-climate-change" class="level3">
<h3 class="anchored" data-anchor-id="additional-words-on-the-severity-of-climate-change">Additional Words on the Severity of Climate Change</h3>
<p>From the Intergovernmental Panel on Climate Change (IPOC): “Recent changes in the climate are widespread, rapid, and intensifying, and unprecedented in thousands of years. Unless there are immediate, rapid, and large-scale reductions in greenhouse gas emissions, limiting warming to 1.5 C will be beyond reach. It is indisputable that human activities are causing climate change, making extreme climate events, including heat waves, heavy rainfall, and droughts more frequent and severe. However, some changes could be slowed and others stopped by limiting warming.”</p>
<p>With every increment of global warming, changes get larger:</p>
<p><img src="images/slide36.png" width="800"></p>
<p>A decade ago scientists would argue that we can’t attribute any single weather event to climate. In the last decade, we have all experienced major shifts in our climate through changes in our local weather and scientists have figured out ‘climate change attribution’.</p>
<p>They look at the probability of the occurence of an event (e.g.&nbsp;a temperature extreme) in models run without human-influence and them compare it to the probability in models run with human-influence.</p>
<p><img src="images/slide41.png" width="800"></p>
</section>
</section>
<section id="era5-and-xarray" class="level2">
<h2 class="anchored" data-anchor-id="era5-and-xarray">ERA5 and Xarray</h2>
<section id="era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses" class="level3">
<h3 class="anchored" data-anchor-id="era5---5th-gen-ecmwf-atmospheric-global-climate-reanalyses">ERA5 - 5th gen ECMWF atmospheric global climate ReAnalyses</h3>
<p>ERA5 combines vast amounts of historical observations into global estimates using advanced modeling and data assimilation systems. From 1979 - 2019, hourly estimates of atmospheric, land and oceanic climate variables were taken. The number of observations assimilated in ERA5 has increased from approximately 0.75 million per day on average in 1979 to around 24 million per day by the end of 2018. It is a key dataset used for understanding our weather and climate, but it is accessible to only a few privileged institutions.</p>
<p><img src="images/slide52.png" width="800"></p>
</section>
<section id="working-with-xarray" class="level3">
<h3 class="anchored" data-anchor-id="working-with-xarray">Working with Xarray</h3>
<section id="xarray-dataset" class="level4">
<h4 class="anchored" data-anchor-id="xarray-dataset">Xarray: Dataset</h4>
<p>Xarray Datasets are essentially groups of DataArrays. This is <strong>really</strong> valuable when you are looking at datasets that have multidimensional groups of data (e.g.&nbsp;temperature, cloud cover). Some Xarray methods can be applied to all that Dataset contains. For example, you can subset a Dataset and the subset, interpolate, calculate a mean, and it will do this across all the DataArrays the Dataset contains.</p>
</section>
<section id="xarray-read-in-dataset" class="level4">
<h4 class="anchored" data-anchor-id="xarray-read-in-dataset">Xarray: Read in Dataset</h4>
<p><img src="images/slide53.png" width="800"></p>
</section>
<section id="coordinates-vs.-dimensions" class="level4">
<h4 class="anchored" data-anchor-id="coordinates-vs.-dimensions">Coordinates vs.&nbsp;Dimensions</h4>
<p>DataArray objects inside a Dataset may have any number of dimensions but are presumed to share a common coordinate system. Coordinates can also have number of dimensions but denote constant/independent quantities, unlike the varying/dependent quantities that belong in data. A dimension is just a name of an axis, like “time”.</p>
<p><img src="images/slide55.png" width="800"></p>
</section>
<section id="dataarrays-are-data-variables-in-a-dataset" class="level4">
<h4 class="anchored" data-anchor-id="dataarrays-are-data-variables-in-a-dataset">DataArrays are Data Variables in a Dataset</h4>
<p>A DataArray holds multi-dimensional information. DataArray objects inside a Dataset may have any number of dimensions but are presumed to share a common coordinate system.</p>
<p>You can explore the data easily using either of the following syntax:</p>
<ol type="1">
<li>ds[“air_temperature_at_2_metres”]</li>
<li>ds.air_temperature_at_2_metres</li>
</ol>
</section>
<section id="dataarray-access-sel-isel" class="level4">
<h4 class="anchored" data-anchor-id="dataarray-access-sel-isel">DataArray Access: <a href="-%20Only%20used%20for%20DataArrays"></a>, sel, isel</h4>
<ol type="1">
<li><ul>
<li>Ex: point = ds_air_temperature_at_2_metres[0,26,119]</li>
</ul></li>
<li>isel: integer/positional
<ul>
<li>Always 0-based</li>
<li>Slices as usual, end-point exclusive</li>
<li>Ex: point = ds.isel(time = 0, latitude = 26, longitude = 119)</li>
</ul></li>
<li>sel: coordinates
<ul>
<li>Strings, integers (coordinates)</li>
<li>Slices: end-point inclusive!</li>
<li>Ex: point = ds.sel(time = “1979-01”, latitude = 37.125, longitude = 238.875)</li>
</ul></li>
</ol>
</section>
<section id="methods-can-be-called-across-a-dataarray-or-a-dataset" class="level4">
<h4 class="anchored" data-anchor-id="methods-can-be-called-across-a-dataarray-or-a-dataset">Methods can be called across a DataArray or a Dataset</h4>
<p>Select data and plot data in one line (using matplotlib)</p>
<p><img src="images/slide60.png" width="800"></p>
</section>
<section id="weighing-data-using-xarray" class="level4">
<h4 class="anchored" data-anchor-id="weighing-data-using-xarray">Weighing Data Using Xarray</h4>
<p>Xarrry provides the ability to weigh your data</p>
<p><img src="images/slide65.png" width="800"></p>
<p>Xarray methods like .weighted() can be combined with .mean() to create means across coordinates.</p>
<p><img src="images/slide66.png" width="800"></p>
<p>We can use .groupby() in combination with the above methods to calculate the annual temperature cycle.</p>
<p><img src="images/slide70.png" width="800"></p>
</section>
<section id="plotting-temperature-trend-with-respect-to-locatoin" class="level4">
<h4 class="anchored" data-anchor-id="plotting-temperature-trend-with-respect-to-locatoin">Plotting Temperature Trend with Respect to Locatoin</h4>
<p><img src="images/slide73.png" width="800"></p>
</section>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>Xarray is a powerful tool to analyze climate data</li>
<li>The models use “parameterizaitons’, which are approximations for all sorts of different physical processes. Each parameterization uses coefficients derived from data science, but the experiments may be limited or imperfect. Often, parameters are adjusted to compensate for an error, but then end up causing other issues. This is still being worked on.</li>
<li>Society needs more data scientists working with climate and weather scientists to look at data similar to what was presented in this note. People like you can help to find new discoveries, amplify messages about changes to our climate and their impacts, and build machine learning models to replace old parameterizations.</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>